<html>
<head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html;charset=iso-8859-1">
    <meta name="keywords" content="hash,hash, Constructors,sql,limit,offset">
    <title>sql. Getting SQL-query result as a hash</title>

    <script language="JavaScript"><!--
    if(top.frames.length==0) {
        top.location.href='./?hashsql.htm'
    } else {
        if(document.referrer!='' && 0>document.referrer.indexOf(top.frames[0].location.pathname)) {
            top.frames[0].location.hash='hashsql.htm'
        }
    }
    //--></script>

</head>

<body bgcolor="#FFFFFF" text="black">


<table border="0" cellspacing="0" cellpadding="2">
  <tr>
    <td>
      
<span style="font-family:FreeSetC,Arial; font-size:12pt; color:#000000"><b>sql. Getting SQL-query result as a hash
<br>
</b></span>
    </td>
  </tr>
  <tr><td bgcolor="#99D228" height="3"></td></tr>
</table>
<br>



<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>^hash::sql{query}
<br>
^hash::sql{query}[$.limit(n)&nbsp;$.offset(o)&nbsp;$.distinct(true/false)</b><b>&nbsp;</b><b>$.</b><b><a href=app7.htm>bind</a></b><b>[variables&nbsp;hash]&nbsp;$.type[hash/string/table]</b><b>]
<br>
</b><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
This constructor creates hash, in which keys' names are the values of fields in the first column of SQL-query's result. Other columns' names become nested keys' names, and their values become respective keys' values.
<br>
When the result contains only one column, constructor creates the hash, where values of the column become keys of hash associated with logical value </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>truth</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> .
<br>

<br>
Optional parameters:
<br>
<table border="0" cellpadding="1"><tr><td align="left" valign="top" width="210">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$.limit(n)</b>
<br>
</span></td><td align="left" valign="top" width="448">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">get only <span style="font-family:Monospace; font-size:10pt; color:#000000"><b>n</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> records.</span><span style="font-family:Monospace; font-size:10pt; color:#000000">
<br>
</span></span></td></tr><tr><td align="left" valign="top" width="210">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$.offset(o)</b>
<br>
</span></td><td align="left" valign="top" width="448">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">skip first <span style="font-family:Monospace; font-size:10pt; color:#000000"><b>o</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> records of the query result.</span><span style="font-family:Monospace; font-size:10pt; color:#000000">
<br>
</span></span></td></tr><tr><td align="left" valign="top" width="210">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$.bind</b><b>[hash]
<br>
</b><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b><i>[3.1.4]</i></b></span><span style="font-family:Monospace; font-size:10pt; color:#000000">
<br>
</span></span></td><td align="left" valign="top" width="448">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">variables to bind, see &#171;<a href=app7.htm>Queries with bound variables</a>&#187;<span style="font-family:Monospace; font-size:10pt; color:#000000">
<br>
</span></span></td></tr><tr><td align="left" valign="top" width="210">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$.distinct(</b><b>true</b><b>/</b><b>false</b><b>)</b>
<br>
</span></td><td align="left" valign="top" width="448">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>false</b><span style="font-family:Arial; font-size:10pt; color:#000000"> or </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>0</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">=consider duplicate an error (default);
<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>true</b></span><span style="font-family:Arial; font-size:10pt; color:#000000"> or </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>1</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">=get records with unique keys.</span><span style="font-family:Monospace; font-size:10pt; color:#000000">
<br>
</span></span></td></tr><tr><td align="left" valign="top" width="210">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$.type[hash/string/table]
<br>
</b><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b><i>[3.3.0]</i></b>
<br>
</span></span></td><td align="left" valign="top" width="448">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>hash</b><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">=each hash item contain hash (default);
<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>string</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">=each hash item contain string. You must specify </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>exactly&nbsp;two&nbsp;</b><b>columns</b><b>&nbsp;</b></span><span style="font-family:Arial; font-size:10pt; color:#000000">in your SQL query</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">;
<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>table</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">=each hash item containing table.
<br>
</span></span></td></tr></table>
<br>

<br>
By default, duplicate of a value in key column is considered an error, but if you want the method to get the records with unique keys, set flag </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$.distinct(</b><b><a href=boollit.htm>true</a></b><b>)</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">.
<br>
<i>Note: such us</i><i>e</i><i> results in spare data interchange between client and server. You had better change the query so that the desired uniqueness should be the server's responsibility. If you need data as both table and hash, consider using</i><i> </i></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b><i><a href=tablesql.htm>table::sql</a></i></b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><i> </i><i>and</i><i> </i></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b><i><a href=table2hash.htm>table.hash</a></i></b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><i> </i><i>together</i><i>.</i><i>
<br>
</i>
<br>
</span><span style="font-family:FreeSetC,Arial; font-size:12pt; color:#000000"><b>Example</b><b>:</b><b> hash of hash</b><u>
<br>
</u></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">With database containing </span><span style="font-family:Monospace; font-size:10pt; color:#000000">hash_table</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">&#133;</span><span style="font-family:FreeSetC,Arial; font-size:12pt; color:#000000">
<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b><i>pet&nbsp;&nbsp;&nbsp;food&nbsp;&nbsp;&nbsp;aggressive</i></b></span><span style="font-family:Times New Roman; font-size:12pt; color:#000000"><b>
<br>
</b></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>cat&nbsp;&nbsp;&nbsp;milk&nbsp;&nbsp;&nbsp;very</b></span><span style="font-family:Times New Roman; font-size:12pt; color:#000000"><b>
<br>
</b></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>dog&nbsp;&nbsp;&nbsp;bone&nbsp;&nbsp;&nbsp;never</b></span><span style="font-family:Times New Roman; font-size:12pt; color:#000000"><b>
<br>
</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
&#133;the code&#133;</span><span style="font-family:FreeSetC,Arial; font-size:12pt; color:#000000">
<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>^</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=opconnect.htm>connect</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>[</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=app3.htm>connect string</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>]{
<br>
&nbsp;&nbsp;&nbsp;$hash</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>_of_hash</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>[^hash::sql{</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>
<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b><b>select&nbsp;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b><b>&nbsp;&nbsp;&nbsp;</b><b>pet,</b><b>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b><b>food,</b><b>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b><b>aggressive
<br>
</b><b>&nbsp;&nbsp;&nbsp;</b><b>&nbsp;&nbsp;&nbsp;from&nbsp;
<br>
</b><b>&nbsp;&nbsp;&nbsp;</b><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hash_table
<br>
</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>&nbsp;&nbsp;&nbsp;}]
<br>
}
<br>
</b></span></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
&#133;will result in hash of the following structure:
<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>$</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>hash</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>_of_hash</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>[
<br>
&nbsp;&nbsp;&nbsp;$.cat[
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.food[milk]
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.aggressive[very]
<br>
&nbsp;&nbsp;&nbsp;]
<br>
&nbsp;&nbsp;&nbsp;$.dog[
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.food[bone]
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.aggressive[never]
<br>
&nbsp;&nbsp;&nbsp;]
<br>
]
<br>
</b></span></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
&#133;from which we can effectively retrieve information, e.g. in such a way:
<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>$animal[cat]
<br>
$animal</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&nbsp;</b><b>likes&nbsp;eating</b><b>&nbsp;</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>$multi_level_hash.$animal.food</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>
<br>
</b></span></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
</span><span style="font-family:FreeSetC,Arial; font-size:12pt; color:#000000"><b>E</b><b>xample: </b><b>hash of bool
<br>
</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">With database containing </span><span style="font-family:Monospace; font-size:10pt; color:#000000">participants</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> table&#133;
<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b><i>name
<br>
</i></b><b>Konstantin
<br>
Alexander
<br>
</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
&#133;the code&#133;</span><span style="font-family:FreeSetC,Arial; font-size:12pt; color:#000000">
<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>^</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=opconnect.htm>connect</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>[</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=app3.htm>connect string</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>]{
<br>
&nbsp;&nbsp;&nbsp;$participants[^hash::sql{</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>select&nbsp;name&nbsp;from&nbsp;participants</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>}]
<br>
}
<br>
</b></span></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
&#133;will result in hash of the following structure:
<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>$participants[
<br>
&nbsp;&nbsp;&nbsp;$.Konstantin(</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b><a href=boollit.htm>true</a></b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>)
<br>
&nbsp;&nbsp;&nbsp;$.</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>Alexander</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>(t</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>rue</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>)
<br>
]
<br>
</b></span></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
&#133;from which we can effectively retrieve information, e.g. in such a way:
<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>$name[Ivan]
<br>
$name&nbsp;^if($participants.$name){</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>partici</b><b>pates</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>}{</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>do&nbsp;not&nbsp;particip</b><b>ate</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>}</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&nbsp;i</b><b>n&nbsp;the&nbsp;project</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>
<br>
</b></span></span></span><br>

<!--(later)#include virtual="/docs/comment.html" -->


<hr size=1>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr valign="top">
<td><font size="1">Copyright &copy; 1997&#150;2011 Art. Lebedev Studio | <a href="http://www.artlebedev.com/" target="_blank">http://www.artlebedev.com</a></font></td>
<td align="right"><font size="1">Last updated: 04.09.2008</font></td>
</tr>
</table>
</body>
</html>
