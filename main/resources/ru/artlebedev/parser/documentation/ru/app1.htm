<html>
<head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html;charset=windows-1251">
    <meta name="keywords" content="path,file::load,HTTP *">
    <title>Приложение 1. Пути к файлам и каталогам, работа с HTTP-серверами</title>

    <script language="JavaScript"><!--
    if(top.frames.length==0) {
        top.location.href='./?app1.htm'
    } else {
        if(document.referrer!='' && 0>document.referrer.indexOf(top.frames[0].location.pathname)) {
            top.frames[0].location.hash='app1.htm'
        }
    }
    //--></script>

</head>

<body bgcolor="#FFFFFF" text="black">


<table border="0" cellspacing="0" cellpadding="2">
  <tr>
    <td>
      
<span style="font-family:FreeSetC,Arial; font-size:12pt; color:#000000"><b>Приложение 1. Пути к файлам и каталогам, работа с HTTP-серверами
<br>
</b></span>
    </td>
  </tr>
  <tr><td bgcolor="#99D228" height="3"></td></tr>
</table>
<br>



<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Для доступа к файлам и каталогам в Parser можно использовать абсолютный или относительный путь.
<br>

<br>
Абсолютный путь начинается слешем, а файл ищется от корня веб-пространства. Файл по относительному пути ищется от каталога, в котором находится запрошенный документ. 
<br>

<br>
Пример абсолютного пути: 
<br>
<span style="font-family:Monospace; font-size:10pt; color:#000000">/news/archive/20020127/sport.html
<br>
</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
Пример относительного пути:
<br>
относительно каталога </span><span style="font-family:Monospace; font-size:10pt; color:#000000">/news/archive</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">…</span><span style="font-family:Monospace; font-size:10pt; color:#000000">
<br>
20020127/sport.html
<br>
</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
При записи файлов необходимые каталоги создаются  автоматически.
<br>

<br>
<i>Внимание: корень веб-пространства, переданный веб-сервером, можно изменить: см. «</i><i><a href=requestdocroot.htm>Корень веб-пространства</a></i><i>».</i>
<br>

<br>
<i>Внимание: Parser преобразует пути к языку </i></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b><i><a href=opuntainttaint.htm>file-spec</a></i></b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><i> (см. «</i><i><a href=tainting.htm>Внешние и внутренние данные</a></i><i>»).
<br>

<br>

<br>
</i>Также методы…
<br>
<table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="14"><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b></b><font face="Symbol" size="2" color="#000000">&#183;</font><b></b></span></td><td><span style="font-family:Monospace; font-size:10pt; color:#000000"><b><a href=fileload.htm>file::load</a></b><b>
&nbsp;<br>
</b></span></td></tr></table><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="14"><span style="font-family:Monospace; font-size:10pt; color:#000000"><b></b><b></b><font face="Symbol" size="2" color="#000000">&#183;</font><b></b></span></td><td><span style="font-family:Monospace; font-size:10pt; color:#000000"><b><a href=tableload.htm>table::load</a></b><b>
&nbsp;<br>
</b></span></td></tr></table><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td><span style="font-family:Monospace; font-size:10pt; color:#000000"><b></b></span></td><td></td></tr></table><span style="font-family:Monospace; font-size:10pt; color:#000000"></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
…может работать с внешними HTTP-серверами, если имя загружаемого документа содержит префикс
<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;http://</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>

<br>

<br>

<br>
Этим методам также можно задать дополнительные опции загрузки документа по HTTP, это <a href=hash.htm>хеш</a>, ключами которого могут быть:
<br>

<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><table border="0" cellpadding="1"><tr><td align="left" valign="top" width="228">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b><i>Опция</i></b><b>
<br>
</b></span></td><td align="left" valign="top" width="209">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b><i>По-умолчанию</i></b><b>
<br>
</b></span></td><td align="left" valign="top" width="265">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b><i>Значение</i></b><span style="font-family:MS Sans Serif; font-size:8pt; color:#000000">
<br>
</span></span></td></tr><tr><td align="left" valign="top" width="228">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$.charset[</b><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">кодировка</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>]</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
</span></span></td><td align="left" valign="top" width="209">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">берется из заголовка HTTP-ответа
<br>
</span></td><td align="left" valign="top" width="265">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Кодировка документов на удаленном сервере. В эту кодировку перекодируется строка запроса, и из этой кодировки перекодируется ответ. <b><i>[3.1</i></b><b><i>.0</i></b><b><i>]</i></b><b><i>
<br>
</i></b><b><i>
<br>
</i></b><span style="font-family:Arial; font-size:10pt; color:#000000">Также данная опция доступна и при загрузке локальных текстовых файлов.</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> <b><i>[3.</i></b><b><i>2.2</i></b><b><i>]
<br>

<br>
</i></b></span><span style="font-family:Arial; font-size:10pt; color:#000000">Если загружается текстовый файл без указания кодировки и в нём обнаруживается BOM код, то его содержимое автоматически перекодируется из кодировки UTF-8 в текущую кодировку.</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> <b><i>[3.4</i></b><b><i>.</i></b><b><i>1]</i></b></span><span style="font-family:Arial; font-size:10pt; color:#000000">
<br>
</span></span></td></tr><tr><td align="left" valign="top" width="228">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$.timeout(</b><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">секунд</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>)</b>
<br>
</span></span></td><td align="left" valign="top" width="209">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">2 секунды<span style="font-family:Monospace; font-size:10pt; color:#000000">
<br>
</span></span></td><td align="left" valign="top" width="265">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Время ожидания ответа HTTP сервера в секундах. Операция загрузки должна быть завершена за это время, иначе возникнет <a href=parserexceptions.htm>ошибка</a>.<span style="font-family:Monospace; font-size:10pt; color:#000000">
<br>
</span></span></td></tr><tr><td align="left" valign="top" width="228">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$.method[</b><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">HTTP-МЕТОД</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>]</b>
<br>
</span></span></td><td align="left" valign="top" width="209">
<span style="font-family:Monospace; font-size:10pt; color:#000000">GET
<br>
</span></td><td align="left" valign="top" width="265">
<span style="font-family:Arial; font-size:10pt; color:#000000">Название HTTP-метода должно быть указано в верхнем регистре.
<br>

<br>
Название метода можно указывать и в нижнем регистре<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b><i> [3.3.1]</i></b></span><span style="font-family:Monospace; font-size:10pt; color:#000000">
<br>
</span></span></td></tr><tr><td align="left" valign="top" width="228">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$.</b><b>enctype</b><b>[</b><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">CONTENT-TYPE</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>]</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
</span></span></td><td align="left" valign="top" width="209">
<span style="font-family:Arial; font-size:10pt; color:#000000">application/x-www-form-urlencoded<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
</span></span></td><td align="left" valign="top" width="265">
<span style="font-family:Arial; font-size:10pt; color:#000000">Допустимые значение:
<br>
application/x-www-form-urlencoded
<br>
или multipart/form-data.
<br>
Последнее должно быть использовано вместе с методом <span style="font-family:Monospace; font-size:10pt; color:#000000">POST</span><span style="font-family:Arial; font-size:10pt; color:#000000"> в случае, если вы отправляете удалённому серверу файлы.</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b><i> </i></b><b><i>[3.3.1]</i></b>
<br>
</span></span></td></tr><tr><td align="left" valign="top" width="228">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$.form[</b><b>
<br>
&nbsp;&nbsp;</b><b>$.поле[</b><span style="font-family:Arial; font-size:10pt; color:#000000">строка</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>]
<br>
</b><b>&nbsp;&nbsp;</b><b>$.поле[</b></span><span style="font-family:Arial; font-size:10pt; color:#000000">файл</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>]
<br>
</b><b>&nbsp;&nbsp;</b><b>$.поле[</b></span><span style="font-family:Arial; font-size:10pt; color:#000000">$таблица</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>]</b><b>
<br>
&nbsp;&nbsp;…</b><b>
<br>
]</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
</span></span></td><td align="left" valign="top" width="209">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">отсутствует
<br>
</span></td><td align="left" valign="top" width="265">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Параметры запроса. Для <span style="font-family:Monospace; font-size:10pt; color:#000000">GET</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> запроса они будут переданы в </span><span style="font-family:Monospace; font-size:10pt; color:#000000">?строке_запроса</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">. Для запросов с другим </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>method</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">, параметры будут переданы с
<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000">Content-type:&nbsp;application/x-www-form-urlencoded</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
Значением может являться строка, таблица из одного столбца или файл <b><i>[3.</i></b><b><i>3</i></b><b><i>.</i></b><b><i>1</i></b><b><i>]</i></b>.
<br>
<i>
<br>
</i><i>Предпочтительно задавать параметры запросам именно при помощи </i></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$.form</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><i>, </i><i>а не передавать их в </i></span><span style="font-family:Monospace; font-size:10pt; color:#000000">?параметрах</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><i> самостоятельно.</i><i>
<br>

<br>
</i><i>Однако можно передавать их и там и там</i><i>. </i><b><i>[3.1.5]
<br>
</i></b></span></span></td></tr><tr><td align="left" valign="top" width="228">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$.body[</b><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">текст</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>]</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
</span></span></td><td align="left" valign="top" width="209">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">отсутствует
<br>
</span></td><td align="left" valign="top" width="265">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Текст тела запроса (нельзя совмещать с <span style="font-family:Monospace; font-size:10pt; color:#000000"><b>form</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> и методом </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>GET</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">) <b><i>[3.1.2]</i></b>
<br>
</span></span></td></tr><tr><td align="left" valign="top" width="228">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$.cookies[
<br>
</b><b>&nbsp;&nbsp;</b><b>$.имя[</b><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">значение</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>]
<br>
</b><b>&nbsp;&nbsp;…</b><b>
<br>
]</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
</span></span></td><td align="left" valign="top" width="209">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">отсутствует
<br>
</span></td><td align="left" valign="top" width="265">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><a href=hash.htm>Хеш</a>, содержащий список cookies, которые необходимо передать удалённому HTTP-серверу. <b><i>[3.</i></b><b><i>2</i></b><b><i>.</i></b><b><i>3</i></b><b><i>]</i></b>
<br>
</span></td></tr><tr><td align="left" valign="top" width="228">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$.headers[</b><b>
<br>
&nbsp;&nbsp;</b><b>$.</b><b>HTTP-</b><b>ЗАГОЛОВОК[</b><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">значение</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>]</b><b>
<br>
&nbsp;&nbsp;…</b><b>
<br>
]</b>
<br>
</span></span></td><td align="left" valign="top" width="209">
<span style="font-family:Monospace; font-size:10pt; color:#000000">$.User-Agent[parser3]
<br>
</span></td><td align="left" valign="top" width="265">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><a href=hash.htm>Хеш</a>, содержащий дополнительные HTTP-заголовки, которые необходимо передать на HTTP-сервер
<br>

<br>
Значение HTTP-заголовка может быть <a href=dateclass.htm>дата</a>, <a href=stringclass.htm>строка</a> или <a href=hashclass.htm>хеш</a> с обязательным ключом <span style="font-family:Monospace; font-size:10pt; color:#000000"><b>value</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">. 
<br>
Дата может использоваться и в качестве значения поля и в качестве значения атрибута поля, при этом она будет стандартно отформатирована.</span><span style="font-family:Monospace; font-size:10pt; color:#000000">
<br>
</span></span></td></tr><tr><td align="left" valign="top" width="228">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$.any-status(</b><b><a href=boollit.htm>true</a></b><b>)</b>
<br>
</span></td><td align="left" valign="top" width="209">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">false/0<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>
<br>
</b></span></span></td><td align="left" valign="top" width="265">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Логическое: допустим ли статус ответа, не равный 200. Если ЛОЖЬ, и будет получен статус, не равный 200, возникнет системная ошибка <span style="font-family:Monospace; font-size:10pt; color:#000000"><a href=parserexceptions.htm>http.status</a></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">.
<br>
<b><i>[3.0.8]</i></b></span><span style="font-family:Monospace; font-size:10pt; color:#000000">
<br>
</span></span></td></tr><tr><td align="left" valign="top" width="228">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$.omit-post-charset(</b><b><a href=boollit.htm>true</a></b><b>)</b><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
</span></span></td><td align="left" valign="top" width="209">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">false/0
<br>
</span></td><td align="left" valign="top" width="265">
<span style="font-family:Arial; font-size:10pt; color:#000000">Не добавлять в HTTP-заголовок content-type исходящего POST запроса информацию о кодировке (по умолчанию добавляется). <span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b><i>[3.</i></b><b><i>3</i></b><b><i>.</i></b><b><i>0</i></b><b><i>]</i></b>
<br>
</span></span></td></tr><tr><td align="left" valign="top" width="228">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$.user[</b><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">пользователь</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>]</b>
<br>
</span></span></td><td align="left" valign="top" width="209">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">отсутствует<span style="font-family:Monospace; font-size:10pt; color:#000000">
<br>
</span></span></td><td align="left" valign="top" width="265">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Задает параметры запроса к серверу,<span style="font-family:Monospace; font-size:10pt; color:#000000">
<br>
</span></span></td></tr><tr><td align="left" valign="top" width="228">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$.password[</b><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">пароль</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>]</b>
<br>
</span></span></td><td align="left" valign="top" width="209">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">отсутствует<span style="font-family:Monospace; font-size:10pt; color:#000000">
<br>
</span></span></td><td align="left" valign="top" width="265">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">использующему стандартную HTTP авторизацию. <b><i>[3.1</i></b><b><i>.2</i></b><b><i>]</i></b><span style="font-family:Monospace; font-size:10pt; color:#000000">
<br>
</span></span></td></tr></table>
<br>

<br>
</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Для </span><span style="font-family:Monospace; font-size:10pt; color:#000000">^<b><a href=fileload.htm>file::load</a></b><b>[…]</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> также можно дополнительные опции загрузки <b><i>[3.0.8]</i></b>, это <a href=hash.htm>хеш</a>, ключами которого могут быть:
<br>

<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><table border="0" cellpadding="1"><tr><td align="left" valign="top" width="228">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b><i>Опция</i></b><b>
<br>
</b></span></td><td align="left" valign="top" width="188">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b><i>По-умолчанию</i></b><b>
<br>
</b></span></td><td align="left" valign="top" width="242">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b><i>Значение</i></b>
<br>
</span></td></tr><tr><td align="left" valign="top" width="228">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$.offset(</b><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">смещение</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>)</b>
<br>
</span></span></td><td align="left" valign="top" width="188">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">0<span style="font-family:Monospace; font-size:10pt; color:#000000">
<br>
</span></span></td><td align="left" valign="top" width="242">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Загрузить данные начиная с этого смещения (в байтах).
<br>
</span></td></tr><tr><td align="left" valign="top" width="228">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$.limit(</b><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">ограничение</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>)</b>
<br>
</span></span></td><td align="left" valign="top" width="188">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">-1<span style="font-family:Monospace; font-size:10pt; color:#000000">
<br>
</span></span></td><td align="left" valign="top" width="242">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Загрузить не более данного количества байт.<span style="font-family:Monospace; font-size:10pt; color:#000000">
<br>
</span></span></td></tr></table>
<br>
</span></span><br>

<!--#include virtual="/docs/comment.html" -->


<hr size=1>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr valign="top">
<td><font size="1">Copyright &copy; 1997&#150;2011 Art. Lebedev Studio | <a href="http://www.artlebedev.ru/" target="_blank">http://www.artlebedev.ru</a></font></td>
<td align="right"><font size="1">Дата обновления: 22.02.2011</font></td>
</tr>
</table>
</body>
</html>
