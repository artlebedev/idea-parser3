<html>
<head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html;charset=windows-1251">
    <meta name="keywords" content="main,auto.p,sql">
    <title>Урок 4. Шаг второй — переходим к работе с БД</title>

    <script language="JavaScript"><!--
    if(top.frames.length==0) {
        top.location.href='./?lesson4.htm'
    } else {
        if(document.referrer!='' && 0>document.referrer.indexOf(top.frames[0].location.pathname)) {
            top.frames[0].location.hash='lesson4.htm'
        }
    }
    //--></script>

</head>

<body bgcolor="#FFFFFF" text="black">


<table border="0" cellspacing="0" cellpadding="2">
  <tr>
    <td>
      
<span style="font-family:FreeSetC,Arial; font-size:12pt; color:#000000"><b>Урок 4. Шаг второй - переходим к работе с БД
<br>
</b></span>
    </td>
  </tr>
  <tr><td bgcolor="#99D228" height="3"></td></tr>
</table>
<br>



<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Самое главное - не пугайтесь названия урока, даже если вы никогда не работали с базами данных. Без них просто невозможно построить гибкий, легко настраиваемый сайт. Отказ от использования БД не дает никаких преимуществ разработчику, а наоборот, здорово уменьшает возможности по созданию сайта и быстрому динамическому изменению содержимого. Построение серьезного ресурса без БД - это как рыбалка без удилища: вроде бы и можно кого-то поймать, однако делать это крайне неудобно. Иными словами, если вы пока не умеете работать с БД - обязательно научитесь и активно используйте их в своих проектах. На этом закончим агитацию, будем считать, что мы вас убедили в необходимости использования БД.
<br>

<br>
Работать с БД на Parser очень удобно. В Parser встроена мощная система взаимодействия с различными СУБД. В настоящее время Parser может работать с MySQL, Oracle,  PgSQL, а также с любой СУБД через драйверы ODBC (в т.ч. MS SQL, MS Access). Поскольку исходные коды Parser3 являются открытыми, возможно добавление поддержки любых других знакомых вам СУБД после создания соответствующего драйвера. При этом работа с ними не требует практически никаких дополнительных знаний собственно Parser. Все, что  нужно - это подключится к выбранной СУБД и работать, используя SQL в объеме и формате, поддерживаемом СУБД. При передаче SQL-запросов Parser может только заменить апострофы соответствующей конструкцией  в зависимости от СУБД, для «защиты от дурака», а все остальное передается, как есть. 
<br>
<i>
<br>
Существует еще специальная конструкция для записи больших строковых литералов. Oracle, PgSQL и, возможно, какие-то серверы, драйверы к которым будут написаны в будущем, не умеют работать с большими строковыми литералами. Если передаваемая, например, из формы, строка будет содержать больше 2000 [Oracle 7.x] или 4000 [Oracle 8.x] букв, сервер выдаст ошибку «слишком длинный литерал». Если пытаться хитрить, комбинируя «2000букв» + «2000букв», то также будет выдана ошибка «слишком длинная сумма». Для хранения таких конструкций используется тип данных CLOB[Oracle] и OID[PgSQL], а для того, чтобы SQL команды были максимально просты, при записи таких строк необходимо лишь добавить управляющий комментарий, который драйвер соответствующего SQL-сервера соответствующим образом обработает:
<br>
</i><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>
<br>
insert&nbsp;into&nbsp;news&nbsp;text&nbsp;values&nbsp;(/**text**/'$form:text')
<br>
</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><i>
<br>
Слово text в записи /**text**/ - это имя колонки, в которую предназначен следующий за этой конструкцией строковый литерал. Пробелы здесь недопустимы!
<br>
</i>
<br>
Со всеми возможностями Parser по работе с различными СУБД в рамках данного урока мы знакомиться, конечно же, не будем. Остановимся на MySQL. Почему именно на ней? Прежде всего потому, что она очень распространена, и многие веб-проекты используют именно ее. Кроме того, практически все компании, занимающиеся сетевым хостингом, предоставляют клиентам возможность работы с этой СУБД. Ну и, несомненно, немаловажный фактор - она бесплатна, доступна и легка в освоении.
<br>

<br>
Давайте определимся, что будем хранить в базе данных. Очевидный ответ : будем хранить новости. Причем таблица СУБД с новостями должна содержать такие поля: уникальный номер новости в базе, который будет формироваться автоматически СУБД, дата внесения новости в базу, по которой мы будем проводить выборку новостей за конкретное число, заголовок новости и собственно ее текст. Просто, без тонкостей и премудростей, однако это эффективно работает. 
<br>

<br>
Есть еще один вопрос, с которым нужно определиться: каким образом новости будут попадать в базу? Можно их заносить и из командной строки СУБД, но это не удобно. В случае если вы предполагаете строить сайт для intranet, есть вариант использовать в качестве СУБД или средства доступа к БД широко распространенную MS Access. Привычный GUI и copy+paste обеспечат вам любовь многих коллег по работе на долгие годы. Для маленьких баз данных это решение может оказаться оптимальным. Мы же предлагаем решение, ориентированное на Internet - создание на сайте раздела администрирования с формой для ввода новостей прямо из браузера.
<br>

<br>
Постановка задачи закончена, переходим к ее практическому решению. Для дальнейшей работы вам потребуется установленная СУБД MySQL, без которой рассматриваемый здесь пример просто не будет работать. 
<br>

<br>
Прежде всего, средствами MySQL создаем новую базу данных с именем </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>p3test</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">, содержащую одну единственную таблицу news с полями </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>id,&nbsp;date,&nbsp;header,&nbsp;body</b></span><span style="font-family:Times New Roman; font-size:12pt; color:#000000">:
<br>

<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b><table border="1" cellpadding="1"><tr><td align="left" valign="top" width="102">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>id</b><b>
<br>
</b></span></td><td align="left" valign="top" width="335">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>int not null auto_increment primary key</b>
<br>
</span></td></tr><tr><td align="left" valign="top" width="102">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>date</b><b>
<br>
</b></span></td><td align="left" valign="top" width="335">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>date</b>
<br>
</span></td></tr><tr><td align="left" valign="top" width="102">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>header</b><b>
<br>
</b></span></td><td align="left" valign="top" width="335">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>varchar(255)</b>
<br>
</span></td></tr><tr><td align="left" valign="top" width="102">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>body</b>
<br>
</span></td><td align="left" valign="top" width="335">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>text</b>
<br>
</span></td></tr></table>
<br>
</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
Теперь создадим раздел администрирования, который даст возможность заполнить созданную базу данных новостями. Для этого в  корневом каталоге сайта создаем каталог </span><span style="font-family:Monospace; font-size:10pt; color:#000000">admin</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">, а в ней </span><span style="font-family:Monospace; font-size:10pt; color:#000000">index.html</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">,  в который пишем следующее:
<br>

<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>@greeting[]
<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>Администрирование&nbsp;новостей
<br>
</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>
<br>
@body_additional[]
<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>Добавление&nbsp;новостей</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>
<br>

<br>
@body_main[]
<br>
$now[^</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=datenow.htm>date::now</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>[]]
<br>

<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&lt;center&gt;
<br>
&lt;form&nbsp;method="POST"&gt;
<br>
&lt;p&gt;
<br>
Date:&nbsp;&lt;input&nbsp;name="date"&nbsp;value="</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>${now.</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=datefields.htm>year</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>}</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>-</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>${now.</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=datefields.htm>month</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>}</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>-</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>${now.</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=datefields.htm>day</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>}</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>"&gt;
<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
<br>
Header:&nbsp;&lt;input&nbsp;name="header"&gt;
<br>
&lt;/p&gt;
<br>
&lt;p&gt;Body:&lt;br&nbsp;/&gt;
<br>
&lt;textarea&nbsp;cols="50"&nbsp;name="body"&nbsp;rows="5"&gt;&lt;/textarea&gt;
<br>
&lt;/p&gt;
<br>
&lt;p&gt;
<br>
&lt;input&nbsp;type="submit"&nbsp;value="Add&nbsp;New"&nbsp;name="posted"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;
<br>
&lt;input&nbsp;type="reset"&nbsp;value="Cancel"&gt;
<br>
&lt;/p&gt;
<br>
&lt;/form&gt;
<br>

<br>
#начало&nbsp;обработки
<br>
</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>^if(</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=opdef.htm>def </a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>$</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=formfield.htm>form:date</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>&nbsp;</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=exprops.htm>&&</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>&nbsp;def&nbsp;$form:header&nbsp;&amp;&amp;&nbsp;def&nbsp;$form:body){
<br>
&nbsp;&nbsp;&nbsp;^</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=opconnect.htm>connect</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>[$connect_string]{
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=voidsql.htm>void:sql</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>{insert&nbsp;into&nbsp;news
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(date,&nbsp;header,&nbsp;body)
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values&nbsp;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;('$form:date',&nbsp;'$form:header',&nbsp;'$form:body')
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>
<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;…сообщение&nbsp;добавлено
<br>
</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
<br>
}{
<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&nbsp;&nbsp;&nbsp;…дл</b><b>я</b><b>&nbsp;добавления&nbsp;новости&nbsp;необходимо&nbsp;заполнить&nbsp;все&nbsp;поля&nbsp;формы
<br>
</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>}
<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&lt;/center&gt;</b><b>
<br>
</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
Также требуется в корневом файле </span><span style="font-family:Monospace; font-size:10pt; color:#000000">auto.p</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> перед методом </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>main</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> добавить метод </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>auto</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">. Этот метод используется для инициализации глобальных переменных, т.е. переменных, которые будут доступны на всех страницах сайта. В нем мы зададим строку подключения к базе данных, о которой чуть позже. 
<br>

<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>@auto[]
<br>
$connect_string[</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=app3mysql.htm>mysql://root@localhost/p3test</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>]
<br>

<br>
</b></span></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Как видите, структура этой страницы полностью соответствует придуманной нами структуре страниц сайта. Все элементы, как то: приветствие, две части </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>body</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">, </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>footer</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> и </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>header</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> присутствуют. Кстати, вы помните, откуда на этой странице появятся </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>header</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> и </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>footer</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">? Правильно, из функции </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>main</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> корневого </span><span style="font-family:Monospace; font-size:10pt; color:#000000">auto.p</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">). 
<br>

<br>
Незнакомые конструкции только в основной части. Давайте с ней разберемся. В начале обычная HTML форма, с подстановкой текущей даты в поле </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>date</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> как значения по умолчанию. Сделано это исключительно для удобства пользователей. 
<br>

<br>
Легкое недоумение может вызвать запись:
<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>${now.year}</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>-</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>${now.month}</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>-</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>${now.day}
<br>
</b></span></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
Фигурные скобки здесь используются для того, чтобы получить строку вида «2001-11-06» (в таком формате мы собираемся хранить дату новости в БД). Если скобки не ставить, то Parser выдаст ошибку при обработке этого кода, поскольку не сможет понять, что нужно делать. Для него «-» будет частью имени. Запомните, если вам нужно четко отделить имя переменной от следующей за ним буквы, скажем «-», как в нашем случае, нужно записать:
<br>

<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>${имя_переменной}</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>-</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>
<br>
</b></span></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
И в результате вы получите: 
<br>

<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>значение_переменной-
<br>
</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
Обязательно прочитайте страницу, посвященную правилам составления имен.
<br>

<br>
<i>Лучшим решением этой проблемы было бы использовать в этом месте конструкцию </i></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b><i>^date.sql-string[]</i></b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><i>. Попробуйте самостоятельно доработать этот пример, пользуясь справочником. Если не получится - не расстраивайтесь, на следующем уроке мы покажем, как это сделать.</i>
<br>

<br>
Продолжим. Если вам уже доводилось работать с формами, то вы знаете, что формы передают введенные в них значения на дальнейшую обработку каким-либо скриптам. Здесь обработчиком данных формы будет сама страница, содержащая эту форму. Никаких дополнительных скриптов нам не понадобится.
<br>

<br>
После закрывающего тега </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&lt;/form&gt;</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> начинается блок обработки. Вначале с помощью </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>if</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> мы проверяем поля формы на пустоту. Этого можно опять же не делать, но мы хотим создать нечто большее, чем учебный экспонат без практического применения. Для того чтобы осуществить проверку, необходимо получить значения полей этой формы. В Parser это реализуется через статические переменные (поля). Мы просто обращаемся к полям формы, как к статическим полям:
<br>

<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>$form:поле_формы
<br>
</b></span></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
Полученные таким образом значения полей мы и будем проверять на пустоту с помощью оператора </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b><a href=opdef.htm>def</a></b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> и логического «И»(</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b><a href=exprops.htm>&&</a></b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">). Мы уже проверяли объект на существование в третьем уроке, но там был опущен оператор </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>def</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">, поскольку проверяли на пустоту таблицу. Как вы помните, таблица в выражении имеет числовое значение,  равное числу строк в ней, поэтому любая непустая таблица считается определенной.  Здесь же необходимо использовать </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>def</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">, как и в случае проверки на </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>def</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> других объектов. Если в поле ничего не было введено, то значение </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$form:поле_формы</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> будет считаться неопределенным (undefined). После того, как все значения полей заполнены, необходимо поместить их в базу данных. Для этого нужно сначала подключиться к базе данных, а затем выполнить запрос SQL для вставки данных в таблицу. Посмотрите, как мы это делаем: 
<br>

<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>^connect[$connect_string]{
<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>&nbsp;&nbsp;&nbsp;^void:sql{insert&nbsp;into&nbsp;news
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(date,&nbsp;header,&nbsp;body)
<br>
&nbsp;&nbsp;&nbsp;values&nbsp;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;('$form:date',&nbsp;'$form:header',&nbsp;'$form:body')
<br>
&nbsp;&nbsp;&nbsp;}</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>
<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&nbsp;&nbsp;&nbsp;…cообщение&nbsp;добавлено
<br>
</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>}
<br>
</b></span></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
Удобство Parser при работе с базами данных состоит в том, что он, за исключением редких случаев, не требует изучать какие-либо дополнительные операторы, кроме тех, которые предусмотрены в самой СУБД. Сессия работы  с базой данных находится внутри оператора connect, общий синтаксис которого:
<br>

<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>^connect[протокол://строка&nbsp;соединения]{методы,&nbsp;передающие&nbsp;запросы&nbsp;SQL}
<br>
</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
Для MySQL это запишется так:
<br>

<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>^connect[mysql://пользователь:пароль@хост/база_данных]{…}
<br>
</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
В фигурных скобках помещаются методы, выполняющие SQL-запросы. При этом любой запрос может возвратить или не возвратить результат (например, в нашем случае нужно просто добавить запись в таблицу БД, не возвращая результат), поэтому Parser предусматривает различные конструкции для создания этих двух типов SQL-запросов. В нашем случае запрос записывается как:
<br>

<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>^void:sql{</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>insert&nbsp;into&nbsp;news&nbsp;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(date,&nbsp;header,&nbsp;body)
<br>
&nbsp;&nbsp;&nbsp;values
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;('</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>$form:date</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>',&nbsp;'</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>$form:header</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>',&nbsp;'</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>$form:body</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>')
<br>
</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>}
<br>
</b></span></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
Кстати, это статический метод класса </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>void</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">, помните про двоеточие?
<br>

<br>
То, что здесь не выделено цветом, является командами SQL.  Ничего сложного здесь нет. Если вы знакомы с SQL, то больше ничего и не потребуется, а если почему-то пока не знакомы, мы вновь рекомендуем его изучить. Вам это многократно пригодится в дальнейшем. Время, потраченное на это изучение, не пропадет даром.
<br>

<br>
Оцените все изящество этого варианта взаимодействия с базой данных - Parser обеспечивает прозрачный доступ к СУБД и, за редким исключением, не требует каких-либо дополнительных знаний. При этом, как вы видите, мы можем помещать в запросы SQL еще и данные из нашей формы, пользуясь конструкциями Parser. Возможности этого симбиоза просто безграничны. СУБД  решает все задачи, связанные с обработкой данных (она ведь именно для этого и предназначена и очень неплохо с этим справляется), а нам остается только воспользоваться результатами ее работы. Все аналогично и с другими СУБД, с которыми вы можете столкнуться в своей работе. 
<br>

<br>
Теперь у нас есть форма, позволяющая помещать записи в нашу БД. Занесите в нее несколько записей. А теперь давайте их оттуда извлекать, но перед этим неплохо бы немного доработать функцию </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>calendar</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">, созданную на предыдущем уроке. Нужно, чтобы в календаре ставились ссылки на дни месяца, а выбранный день передавался как поле формы. Тогда по числам-ссылкам в календаре пользователь будет попадать в архив новостей за выбранный день. Модернизация эта неcложная, просто добавим немного HTML в </span><span style="font-family:Monospace; font-size:10pt; color:#000000">auto.p</span><span style="font-family:Times New Roman; font-size:12pt; color:#000000"> </span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">раздела news: </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$days.$week_day</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> в коде </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>if</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> обнесем ссылками таким образом:
<br>

<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&lt;a&nbsp;href="/news/?day=</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>$days.$week_day</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>"&gt;</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>$days.$week_day</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&lt;/a&gt;
<br>
</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
В результате мы получаем возможность использовать наш календарь в качестве меню доступа к новостям за определенный день.
<br>

<br>
Теперь займемся </span><span style="font-family:Monospace; font-size:10pt; color:#000000">/news/index.html</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">. В него заносим такой код:
<br>

<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>@greeting[]
<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>Страница&nbsp;новостей,&nbsp;&nbsp;заходите&nbsp;чаще!
<br>
</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>@body_additional[]
<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&lt;center&gt;Архив&nbsp;новостей&nbsp;за&nbsp;текущий&nbsp;месяц:&lt;/center&gt;
<br>
&lt;br&nbsp;/&gt;</b><b>
<br>
</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>^calendar[]
<br>

<br>
@body_main[]
<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>$now[^</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=datenow.htm>date::now</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>[]]
<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&lt;b&gt;&lt;h1&gt;НОВОСТИ&lt;/h1&gt;&lt;/b&gt;
<br>
</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>$day(^if(def&nbsp;$form:day){
<br>
&nbsp;&nbsp;&nbsp;$</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=formclass.htm>form</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>:</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=formfields.htm>day</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>
<br>
}{
<br>
&nbsp;&nbsp;&nbsp;$now.</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=datefields.htm>day</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>
<br>
}</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>)</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>
<br>
^</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=opconnect.htm>connect</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>[$connect_string]{
<br>
&nbsp;&nbsp;&nbsp;$news[^</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=tablesql.htm>table::sql</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>{select
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;date,&nbsp;header,&nbsp;body&nbsp;
<br>
&nbsp;&nbsp;&nbsp;from
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;news&nbsp;
<br>
&nbsp;&nbsp;&nbsp;where
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;date='${now.</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=datefields.htm>year</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>}-${now.</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=datefields.htm>month</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>}-$day'
<br>
&nbsp;&nbsp;&nbsp;}]
<br>
&nbsp;&nbsp;&nbsp;^if($news){
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^news.</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=tablemenu.htm>menu</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>{
<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>$news.</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=tablefields.htm>date</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>&nbsp;-&nbsp;$news.</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=tablefields.htm>header</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&lt;/b&gt;&lt;br&nbsp;/&gt;</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=opuntainttaint.htm>untaint</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>{$news.</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=tablefields.htm>body</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>}</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&lt;br&nbsp;/&gt;</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}[</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&lt;br&nbsp;/&gt;</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>]
<br>
&nbsp;&nbsp;&nbsp;}{
<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;За&nbsp;указанный&nbsp;период&nbsp;новостей&nbsp;не&nbsp;найдено.
<br>
</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>&nbsp;&nbsp;&nbsp;}
<br>
}
<br>
</b></span></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
Структура обычная. В дополнительной части </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>body</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> помещаем меню-календарь вызовом </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>^calendar[]</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> (напомним, что эта функция определена в </span><span style="font-family:Monospace; font-size:10pt; color:#000000">auto.p</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> раздела </span><span style="font-family:Monospace; font-size:10pt; color:#000000">news</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">). Основа информационной части страницы - выборка из базы данных новостей за тот день, по которому щелкнул пользователь (условие </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>where</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> в SQL-запросе). Это второй вариант SQL-запроса, при котором результат возвращается. Обратите внимание, здесь результатом запроса будет таблица, с которой в дальнейшем мы будем работать. Поэтому необходимо создать объект класса </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>table</b></span><span style="font-family:Times New Roman; font-size:12pt; color:#000000">.</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> 
<br>

<br>
Познакомимся с еще одним конструктором класса </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>table</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> - конструктором на базе SQL-запроса. Его логика абсолютно аналогична работе конструктора </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>^</b><b><a href=tableload.htm>table::load</a></b><b>[]</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">, только источником данных для таблицы является не текстовый файл, как в случае с пунктами меню, а результат работы SQL-запроса - выборка из базы данных:
<br>

<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$переменная[^table::sql{код&nbsp;SQL&nbsp;запроса}]
<br>
</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
Воспользоваться этим конструктором вы можете только внутри оператора </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>^connect[]</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">, то есть когда имеется установленное соединение с базой данных, поскольку обработкой SQL-запросов занимается сама СУБД. Результатом будет именованная таблица, имена столбцов которой совпадают с заголовками, возвращаемыми SQL-сервером в ответ на запрос.
<br>

<br>
<i>Небольшое отступление. При создании SQL-запросов следует избегать использования конструкций вида select * from … поскольку для постороннего человека, не знающего структуру таблицы, к которой происходит обращение, невозможно понять, какие данные вернутся из БД. Подобные конструкции можно использовать только для отладочных целей, а в окончательном коде лучше всегда явно указывать названия полей таблиц, из которых делается выборка данных.
<br>
</i>
<br>
Остальная часть кода уже не должна вызывать вопросов: </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>if</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> обрабатывает ситуацию, когда поле </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>day</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> (выбранный пользователем день на календаре, который передается из функции </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>calendar</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">) не определено, то есть человек пришел из другого раздела сайта через меню навигации. Если поле формы </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>day</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> определено (</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>def</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">), то используется день, переданный посетителем, в противном случае используем текущее число. Далее соединяемся с БД, также как мы это делали, когда добавляли новости, создаем таблицу </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$news</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">, в которую заносим новости за запрошенный день (результат SQL-запроса), после чего с помощью метода </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>menu</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> последовательно перебираем строки таблицы </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>news</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> и выводим новости, обращаясь к ее полям. Все понятно и знакомо, кроме одного вспомогательного оператора, который служит для специфического вывода текста новости: 
<br>

<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>^untaint{$news.body}
<br>
</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><i>
<br>
Отвлекитесь немного и внимательно прочитайте раздел справочника, посвященный операторам </i><a href=opuntainttaint.htm>taint и untaint</a><i>, где подробно описана логика их работы. Это очень важные операторы и вы наверняка столкнетесь с необходимостью их использования. К тому же большой объем работы по обработке данных Parser делает самостоятельно, она не видна на первый взгляд, но понимать логику действий необходимо.</i></span><span style="font-family:Times New Roman; font-size:12pt; color:#000000"><i>
<br>
</i></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
Прочитали? Теперь продолжим. Зачем он нужен здесь? У нас есть страница для администрирования новостей, и мы хотим разрешить использование тегов HTML в записях. По умолчанию это запрещено, чтобы посторонний человек не мог внести Java-скрипт, например, перенаправляющий пользователя на другой сайт. Как это сделать? Да очень просто: достаточно выборку записей из таблицы преобразовать с помощью оператора </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b><a href=opuntainttaint.htm>untaint</a></b></span><span style="font-family:Times New Roman; font-size:12pt; color:#000000"><b>:</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>

<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>^untaint{текст&nbsp;новости}
<br>
</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
В нашем случае используется значение по умолчанию </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>[as-is]</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">, которое означает, что данные будут выведены так, как они есть в базе. Мы можем позволить себе поступить так, поскольку изначально не предполагается доступ обычных пользователей к разделу администрирования, через который добавляются новости.
<br>

<br>
Теперь можно немного расслабиться - новостной блок нашего сайта завершен. Мы можем добавлять новости и получать их выборку за указанный пользователем день. На этом четвертый урок будем считать оконченным, хотя есть некоторые детали, которые можно доработать, а именно: научить календарь не ставить ссылки на дни после текущего, выводить в заголовке информационной части дату, за которую показываются новости, да и просто реализовать возможность доступа к новостям не только за текущий месяц, но и за предыдущие. Однако это уже задание вам. Знаний, полученных на предыдущих уроках вполне достаточно, чтобы доработать этот пример под свои требования и желания. Творите!
<br>

<br>
Подведем итоги четвертого урока. 
<br>

<br>
</span><span style="font-family:FreeSetC,Arial; font-size:12pt; color:#000000"><b>Что мы сделали:</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> создали раздел администрирования для добавления новостей. Модернизировали функцию, формирующую календарь на текущий месяц. Наполнили раздел новостей данными из БД на основе запроса пользователей либо по умолчанию за текущую дату. 
<br>

<br>
</span><span style="font-family:FreeSetC,Arial; font-size:12pt; color:#000000"><b>Что узнали:</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
<table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="14"><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><font face="Symbol" size="2" color="#000000">&#183;</font></span></span></td><td><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">механизм взаимодействия Parser с СУБД MySQL
&nbsp;<br>
</span></td></tr></table><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="14"><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><font face="Symbol" size="2" color="#000000">&#183;</font></span></td><td><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">как осуществлять различные SQL-запросы к БД (статический метод </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b><a href=voidsql.htm>sql</a></b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> класса </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b><a href=voidclass.htm>void</a></b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> и конструктор </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b><a href=tablesql.htm>sql</a></b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> класса </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b><a href=tableclass.htm>table</a></b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">) 
&nbsp;<br>
</span></td></tr></table><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="14"><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><font face="Symbol" size="2" color="#000000">&#183;</font></span></td><td><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">оператор </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=opuntainttaint.htm>untaint</a></b></span></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> 
&nbsp;<br>
</span></td></tr></table><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"></span></td><td></td></tr></table><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
</span><span style="font-family:FreeSetC,Arial; font-size:12pt; color:#000000"><b>Что надо запомнить:</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> работа с базами данных в Parser осуществляется легко и понятно, нужно только изучить работу самой СУБД. Не отказывайтесь от использования БД в своих работах.
<br>

<br>
</span><span style="font-family:FreeSetC,Arial; font-size:12pt; color:#000000"><b>Что будем делать дальше:</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> с разделом новостей закончено, переходим к созданию гостевой книги для нашего сайта, чтобы можно было определять, какова популярность у пользователей созданного совместными усилиями творения.
<br>
</span></span><br>

<!--#include virtual="/docs/comment.html" -->


<hr size=1>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr valign="top">
<td><font size="1">Copyright &copy; 1997&#150;2011 Art. Lebedev Studio | <a href="http://www.artlebedev.ru/" target="_blank">http://www.artlebedev.ru</a></font></td>
<td align="right"><font size="1">Дата обновления: 25.11.2010</font></td>
</tr>
</table>
</body>
</html>
