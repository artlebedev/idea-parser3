<html>
<head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html;charset=windows-1251">
    <meta name="keywords" content="taint,untaint">
    <title>Внешние и внутренние данные</title>

    <script language="JavaScript"><!--
    if(top.frames.length==0) {
        top.location.href='./?tainting.htm'
    } else {
        if(document.referrer!='' && 0>document.referrer.indexOf(top.frames[0].location.pathname)) {
            top.frames[0].location.hash='tainting.htm'
        }
    }
    //--></script>

</head>

<body bgcolor="#FFFFFF" text="black">


<table border="0" cellspacing="0" cellpadding="2">
  <tr>
    <td>
      
<span style="font-family:FreeSetC,Arial; font-size:12pt; color:#000000"><b>Внешние и внутренние данные
<br>
</b></span>
    </td>
  </tr>
  <tr><td bgcolor="#99D228" height="3"></td></tr>
</table>
<br>



<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Создавая код на Parser, мы имеем дело с двумя видами данных. Один из них  - это все то, что написано самим кодером. Второй - данные, получаемые кодом извне, а именно из форм, переменных окружения, файлов, от SQL-серверов, из cookies и т.п. Все то, что создано кодером, не нуждается в проверке на корректность. Вместе с тем, когда данные поступают, например, от пользователей через поля форм, выводить их «<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>as-is</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">» (как есть) может быть потенциально опасно. Возникает необходимость преобразования таких данных по определенным правилам. Большую часть работы по подобным преобразованиям Parser выполняет автоматически, не требуя вмешательства со стороны. Например, если присутствует вывод данных, введенных через поле формы, то в них символы </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&lt;&nbsp;&gt;</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> автоматически будут заменены на </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&amp;lt;</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> и </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&amp;gt;</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">. Иногда наоборот бывает необходимо позволить вывод таких данных именно в том виде, в котором они поступили. 
<br>

<br>
Для Parser «свой» код, т.е. тот, который набрал кодер, считается </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>clean</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> («чистым»). Все данные, которые поступают извне, считаются </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>tainted</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> («грязными» или «окрашенными»).
<br>

<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>код&nbsp;Parser</b></span></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> - этот код создан скриптовальщиком, поэтому никаких вопросов не вызывает;
<br>

<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>$</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=formclass.htm>form</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>:</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=formfield.htm>field</a></b></span></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> - здесь должны быть выведены данные, введенные пользователем через форму;
<br>

<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>$my_table[^</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=tableclass.htm>table</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>::</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=tablesql.htm>sql</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>{запрос}]</b></span></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> - здесь данные поступают из БД.
<br>

<br>
В случае с </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$form:field</b><b>,</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> поступившие </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>tainted</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> данные будут автоматически преобразованы и некоторые символы заменятся в соответствии с внутренней таблицей замен Parser. После этого они станут </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>clean</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> («чистыми»), и их «окрашенность» исчезнет. Здесь неявно выполняется операция </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>untaint</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> (снять «окраску»). Автоматическое преобразование данных происходит в тот момент, когда эти данные будут выводиться. Так, в случае с помещением данных, поступивших из БД, в переменную </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$my_table</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">, преобразование выполнится в тот момент, когда данные будут в каком-либо виде выданы во внешнюю среду (переданы браузеру, сохранены в файл или базу данных). 
<br>

<br>
Вместе с тем, бывают ситуации, когда необходимости в таком преобразовании нет,  либо данные нужно преобразовать по другим правилам, чем это делает Parser по умолчанию. Например, нам нужно разрешить пользователю вводить HTML-теги через поле формы для дополнительного форматирования текста. Но, так как это чревато неприятностями (ввод Java-скрипта в гостевой книге может перенаправлять пользователей с вашего сайта на вражеский), Parser сам заменит «нежелательные» символы в соответствии со своими правилами. Решение - использование оператора </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b><a href=opuntainttaint.htm>untaint</a></b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">.
<br>
</span></span><br>

<!--#include virtual="/docs/comment.html" -->


<hr size=1>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr valign="top">
<td><font size="1">Copyright &copy; 1997&#150;2011 Art. Lebedev Studio | <a href="http://www.artlebedev.ru/" target="_blank">http://www.artlebedev.ru</a></font></td>
<td align="right"><font size="1">Дата обновления: 18.02.2008</font></td>
</tr>
</table>
</body>
</html>
