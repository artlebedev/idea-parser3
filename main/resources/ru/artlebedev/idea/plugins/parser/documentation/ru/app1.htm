<html>
<head>
    
    
    <title>Приложение 1. Пути к файлам и каталогам, работа с HTTP-серверами</title><meta content="text/html; charset=utf-8" http-equiv="Content-Type">

    

</head>

<body>


<table border="0" cellspacing="0" cellpadding="2">
  <tr>
    <td>
      
<span class="h1"><b>Приложение 1. Пути к файлам и каталогам, работа с HTTP-серверами
<br />
</b></span>
    </td>
  </tr>
  <tr><td><div class="greenline"></div></td></tr>
</table>
<br />



<span>Для доступа к файлам и каталогам в Parser можно использовать абсолютный или относительный путь.
<br />

<br />
Абсолютный путь начинается слешем, а файл ищется от корня веб-пространства. Файл по относительному пути ищется от каталога, в котором находится запрошенный документ. 
<br />

<br />
Пример абсолютного пути: 
<br />
<span class="mono">/news/archive/20020127/sport.html
<br />
</span><span>
<br />
Пример относительного пути:
<br />
относительно каталога </span><span class="mono">/news/archive</span><span>…</span><span class="mono">
<br />
20020127/sport.html
<br />
</span><span>
<br />
При записи файлов необходимые каталоги создаются  автоматически.
<br />

<br />
<i>Внимание: корень веб-пространства, переданный веб-сервером, можно изменить: см. «</i><i><a href="requestdocroot.htm">Корень веб-пространства</a></i><i>».</i>
<br />

<br />
<i>Внимание: Parser преобразует пути к языку </i></span><span class="mono"><b><i><a href="opuntainttaint.htm">file-spec</a></i></b></span><span><i> (см. «</i><i><a href="tainting.htm">Внешние и внутренние данные</a></i><i>»).
<br />

<br />

<br />
</i>Также методы…
<br />
<table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="14"><span></span></span><span class="mono"><b></b><font face="Symbol" size="2" color="#000000">&#183;</font><b></b></span></td><td><span class="mono"><b><a href="fileload.htm">file::load</a></b><b>
&nbsp;<br />
</b></span></td></tr></table><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="14"><span class="mono"><b></b><b></b><font face="Symbol" size="2" color="#000000">&#183;</font><b></b></span></td><td><span class="mono"><b><a href="tableload.htm">table::load</a></b><b>
&nbsp;<br />
</b></span></td></tr></table><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td><span class="mono"><b></b></span></td><td></td></tr></table><span class="mono"></span><span>
<br />
…может работать с внешними HTTP-серверами, если имя загружаемого документа содержит префикс
<br />
</span><span class="mono">&nbsp;&nbsp;&nbsp;&nbsp;http://</span><span>
<br />

<br />

<br />

<br />
Этим методам также можно задать дополнительные опции загрузки документа по HTTP, это <a href="hash.htm">хеш</a>, ключами которого могут быть:
<br />

<br />
</span><span class="mono"><table border="0" cellpadding="1"><tr><td align="left" valign="top" width="228">
<span><b><i>Опция</i></b><b>
<br />
</b></span></td><td align="left" valign="top" width="209">
<span><b><i>По-умолчанию</i></b><b>
<br />
</b></span></td><td align="left" valign="top" width="265">
<span><b><i>Значение</i></b><span style="font-family:MS Sans Serif; font-size:8pt; color:#000000">
<br />
</span></span></td></tr><tr><td align="left" valign="top" width="228">
<span class="mono"><b>$.charset[</b><span>кодировка</span><span class="mono"><b>]</b></span><span>
<br />
</span></span></td><td align="left" valign="top" width="209">
<span>берется из заголовка HTTP-ответа
<br />
</span></td><td align="left" valign="top" width="265">
<span>Кодировка документов на удаленном сервере. В эту кодировку перекодируется строка запроса, и из этой кодировки перекодируется ответ. <b><i>[3.1</i></b><b><i>.0</i></b><b><i>]</i></b><b><i>
<br />
</i></b><b><i>
<br />
</i></b><span>Также данная опция доступна и при загрузке локальных текстовых файлов.</span><span> <b><i>[3.</i></b><b><i>2.2</i></b><b><i>]
<br />

<br />
</i></b></span><span>Если загружается текстовый файл без указания кодировки и в нём обнаруживается BOM код, то его содержимое автоматически перекодируется из кодировки UTF-8 в текущую кодировку.</span><span> <b><i>[3.4</i></b><b><i>.</i></b><b><i>1]</i></b></span><span>
<br />
</span></span></td></tr><tr><td align="left" valign="top" width="228">
<span class="mono"><b>$.timeout(</b><span>секунд</span><span class="mono"><b>)</b>
<br />
</span></span></td><td align="left" valign="top" width="209">
<span>2 секунды<span class="mono">
<br />
</span></span></td><td align="left" valign="top" width="265">
<span>Время ожидания ответа HTTP сервера в секундах. Операция загрузки должна быть завершена за это время, иначе возникнет <a href="parserexceptions.htm">ошибка</a>.<span class="mono">
<br />
</span></span></td></tr><tr><td align="left" valign="top" width="228">
<span class="mono"><b>$.method[</b><span>HTTP-МЕТОД</span><span class="mono"><b>]</b>
<br />
</span></span></td><td align="left" valign="top" width="209">
<span class="mono">GET
<br />
</span></td><td align="left" valign="top" width="265">
<span>Название HTTP-метода должно быть указано в верхнем регистре.
<br />

<br />
Название метода можно указывать и в нижнем регистре<span><b><i> [3.3.1]</i></b></span><span class="mono">
<br />
</span></span></td></tr><tr><td align="left" valign="top" width="228">
<span class="mono"><b>$.</b><b>enctype</b><b>[</b><span>CONTENT-TYPE</span><span class="mono"><b>]</b></span><span>
<br />
</span></span></td><td align="left" valign="top" width="209">
<span>application/x-www-form-urlencoded<span>
<br />
</span></span></td><td align="left" valign="top" width="265">
<span>Допустимые значение:
<br />
application/x-www-form-urlencoded
<br />
или multipart/form-data.
<br />
Последнее должно быть использовано вместе с методом <span class="mono">POST</span><span> в случае, если вы отправляете удалённому серверу файлы.</span><span><b><i> </i></b><b><i>[3.3.1]</i></b>
<br />
</span></span></td></tr><tr><td align="left" valign="top" width="228">
<span class="mono"><b>$.form[</b><b>
<br />
&nbsp;&nbsp;</b><b>$.поле[</b><span>строка</span><span class="mono"><b>]
<br />
</b><b>&nbsp;&nbsp;</b><b>$.поле[</b></span><span>файл</span><span class="mono"><b>]
<br />
</b><b>&nbsp;&nbsp;</b><b>$.поле[</b></span><span>$таблица</span><span class="mono"><b>]</b><b>
<br />
&nbsp;&nbsp;…</b><b>
<br />
]</b></span><span>
<br />
</span></span></td><td align="left" valign="top" width="209">
<span>отсутствует
<br />
</span></td><td align="left" valign="top" width="265">
<span>Параметры запроса. Для <span class="mono">GET</span><span> запроса они будут переданы в </span><span class="mono">?строке_запроса</span><span>. Для запросов с другим </span><span class="mono"><b>method</b></span><span>, параметры будут переданы с
<br />
</span><span class="mono">Content-type:&nbsp;application/x-www-form-urlencoded</span><span>
<br />
Значением может являться строка, таблица из одного столбца или файл <b><i>[3.</i></b><b><i>3</i></b><b><i>.</i></b><b><i>1</i></b><b><i>]</i></b>.
<br />
<i>
<br />
</i><i>Предпочтительно задавать параметры запросам именно при помощи </i></span><span class="mono"><b>$.form</b></span><span><i>, </i><i>а не передавать их в </i></span><span class="mono">?параметрах</span><span><i> самостоятельно.</i><i>
<br />

<br />
</i><i>Однако можно передавать их и там и там</i><i>. </i><b><i>[3.1.5]
<br />
</i></b></span></span></td></tr><tr><td align="left" valign="top" width="228">
<span class="mono"><b>$.body[</b><span>текст</span><span class="mono"><b>]</b></span><span>
<br />
</span></span></td><td align="left" valign="top" width="209">
<span>отсутствует
<br />
</span></td><td align="left" valign="top" width="265">
<span>Текст тела запроса (нельзя совмещать с <span class="mono"><b>form</b></span><span> и методом </span><span class="mono"><b>GET</b></span><span>) <b><i>[3.1.2]</i></b>
<br />
</span></span></td></tr><tr><td align="left" valign="top" width="228">
<span class="mono"><b>$.cookies[
<br />
</b><b>&nbsp;&nbsp;</b><b>$.имя[</b><span>значение</span><span class="mono"><b>]
<br />
</b><b>&nbsp;&nbsp;…</b><b>
<br />
]</b></span><span>
<br />
</span></span></td><td align="left" valign="top" width="209">
<span>отсутствует
<br />
</span></td><td align="left" valign="top" width="265">
<span><a href="hash.htm">Хеш</a>, содержащий список cookies, которые необходимо передать удалённому HTTP-серверу. <b><i>[3.</i></b><b><i>2</i></b><b><i>.</i></b><b><i>3</i></b><b><i>]</i></b>
<br />
</span></td></tr><tr><td align="left" valign="top" width="228">
<span class="mono"><b>$.headers[</b><b>
<br />
&nbsp;&nbsp;</b><b>$.</b><b>HTTP-</b><b>ЗАГОЛОВОК[</b><span>значение</span><span class="mono"><b>]</b><b>
<br />
&nbsp;&nbsp;…</b><b>
<br />
]</b>
<br />
</span></span></td><td align="left" valign="top" width="209">
<span class="mono">$.User-Agent[parser3]
<br />
</span></td><td align="left" valign="top" width="265">
<span><a href="hash.htm">Хеш</a>, содержащий дополнительные HTTP-заголовки, которые необходимо передать на HTTP-сервер
<br />

<br />
Значение HTTP-заголовка может быть <a href="dateclass.htm">дата</a>, <a href="stringclass.htm">строка</a> или <a href="hashclass.htm">хеш</a> с обязательным ключом <span class="mono"><b>value</b></span><span>. 
<br />
Дата может использоваться и в качестве значения поля и в качестве значения атрибута поля, при этом она будет стандартно отформатирована.</span><span class="mono">
<br />
</span></span></td></tr><tr><td align="left" valign="top" width="228">
<span class="mono"><b>$.any-status(</b><b><a href="boollit.htm">true</a></b><b>)</b>
<br />
</span></td><td align="left" valign="top" width="209">
<span>false/0<span class="mono"><b>
<br />
</b></span></span></td><td align="left" valign="top" width="265">
<span>Логическое: допустим ли статус ответа, не равный 200. Если ЛОЖЬ, и будет получен статус, не равный 200, возникнет системная ошибка <span class="mono"><a href="parserexceptions.htm">http.status</a></span><span>.
<br />
<b><i>[3.0.8]</i></b></span><span class="mono">
<br />
</span></span></td></tr><tr><td align="left" valign="top" width="228">
<span class="mono"><b>$.omit-post-charset(</b><b><a href="boollit.htm">true</a></b><b>)</b><span>
<br />
</span></span></td><td align="left" valign="top" width="209">
<span>false/0
<br />
</span></td><td align="left" valign="top" width="265">
<span>Не добавлять в HTTP-заголовок content-type исходящего POST запроса информацию о кодировке (по умолчанию добавляется). <span><b><i>[3.</i></b><b><i>3</i></b><b><i>.</i></b><b><i>0</i></b><b><i>]</i></b>
<br />
</span></span></td></tr><tr><td align="left" valign="top" width="228">
<span class="mono"><b>$.user[</b><span>пользователь</span><span class="mono"><b>]</b>
<br />
</span></span></td><td align="left" valign="top" width="209">
<span>отсутствует<span class="mono">
<br />
</span></span></td><td align="left" valign="top" width="265">
<span>Задает параметры запроса к серверу,<span class="mono">
<br />
</span></span></td></tr><tr><td align="left" valign="top" width="228">
<span class="mono"><b>$.password[</b><span>пароль</span><span class="mono"><b>]</b>
<br />
</span></span></td><td align="left" valign="top" width="209">
<span>отсутствует<span class="mono">
<br />
</span></span></td><td align="left" valign="top" width="265">
<span>использующему стандартную HTTP авторизацию. <b><i>[3.1</i></b><b><i>.2</i></b><b><i>]</i></b><span class="mono">
<br />
</span></span></td></tr></table>
<br />

<br />
</span><span>Для </span><span class="mono">^<b><a href="fileload.htm">file::load</a></b><b>[…]</b></span><span> также можно дополнительные опции загрузки <b><i>[3.0.8]</i></b>, это <a href="hash.htm">хеш</a>, ключами которого могут быть:
<br />

<br />
</span><span class="mono"><table border="0" cellpadding="1"><tr><td align="left" valign="top" width="228">
<span><b><i>Опция</i></b><b>
<br />
</b></span></td><td align="left" valign="top" width="188">
<span><b><i>По-умолчанию</i></b><b>
<br />
</b></span></td><td align="left" valign="top" width="242">
<span><b><i>Значение</i></b>
<br />
</span></td></tr><tr><td align="left" valign="top" width="228">
<span class="mono"><b>$.offset(</b><span>смещение</span><span class="mono"><b>)</b>
<br />
</span></span></td><td align="left" valign="top" width="188">
<span>0<span class="mono">
<br />
</span></span></td><td align="left" valign="top" width="242">
<span>Загрузить данные начиная с этого смещения (в байтах).
<br />
</span></td></tr><tr><td align="left" valign="top" width="228">
<span class="mono"><b>$.limit(</b><span>ограничение</span><span class="mono"><b>)</b>
<br />
</span></span></td><td align="left" valign="top" width="188">
<span>-1<span class="mono">
<br />
</span></span></td><td align="left" valign="top" width="242">
<span>Загрузить не более данного количества байт.<span class="mono">
<br />
</span></span></td></tr></table>
<br />
</span></span><br />




</body>
</html>