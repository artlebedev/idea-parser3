<html>
<head>
    
    
    <title>send. Отправка сообщения по электронной почте</title><meta content="text/html; charset=utf-8" http-equiv="Content-Type">

    

</head>

<body>


<table border="0" cellspacing="0" cellpadding="2">
  <tr>
    <td>
      
<span class="h1"><b>send. Отправка сообщения по электронной почте
<br />
</b></span>
    </td>
  </tr>
  <tr><td><div class="greenline"></div></td></tr>
</table>
<br />



<span class="mono"><b>^mail:send[сообщение]
<br />
</b><span>
<br />
Метод отправляет </span><span class="mono"><b>сообщение</b></span><span> на заданный адрес электронной почты. Можно указать несколько адресов через запятую.
<br />
Пример:
<br />
</span><span class="mono"><span class="monoblue"><b>^mail:send[
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.from[</b></span></span><span class="mono"><b>Вася&nbsp;&lt;vasya@hotmail.ru&gt;</b><span class="monoblue"><b>]
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.to[</b></span></span><span class="mono"><b>Петя&nbsp;&lt;petya@hotmail.ru&gt;</b><span class="monoblue"><b>]
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.subject[</b></span></span><span class="mono"><b>как&nbsp;дела</b><span class="monoblue"><b>]
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.text[</b></span></span><span class="mono"><b>Как&nbsp;у&nbsp;тебя&nbsp;дела?&nbsp;У&nbsp;меня&nbsp;-&nbsp;изумительно!</b><span class="monoblue"><b>]
<br />
]
<br />
</b></span></span><span>В результате будет отправлено сообщение для </span><span class="mono"><b>petya@hotmail.ru</b></span><span>  с содержимым "Как у тебя дела? У меня - изумительно!".
<br />

<br />
</span><span class="mono"><b>сообщение</b></span><span> - <a href="hash.htm">хеш</a>, в котором могут быть заданы такие ключи:
<br />
<table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="14"><span></span></span><span class="mono"><b></b><font face="Symbol" size="2" color="#000000">&#183;</font><b></b></span></td><td><span class="mono"><b>поле_заголовка
&nbsp;<br />
</b></span></td></tr></table><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="14"><span class="mono"><b></b><font face="Symbol" size="2" color="#000000">&#183;</font><b></b></span></td><td><span class="mono"><b>text
&nbsp;<br />
</b></span></td></tr></table><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="14"><span class="mono"><b></b><font face="Symbol" size="2" color="#000000">&#183;</font><b></b></span></td><td><span class="mono"><b>html
&nbsp;<br />
</b></span></td></tr></table><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="14"><span class="mono"><b></b><font face="Symbol" size="2" color="#000000">&#183;</font><b></b></span></td><td><span class="mono"><b>file
&nbsp;<br />
</b></span></td></tr></table><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="14"><span class="mono"><b></b><font face="Symbol" size="2" color="#000000">&#183;</font><b></b></span></td><td><span class="mono"><b>charset
&nbsp;<br />
</b></span></td></tr></table><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="14"><span class="mono"><b></b><font face="Symbol" size="2" color="#000000">&#183;</font><b></b></span></td><td><span class="mono"><b>options&nbsp;&nbsp;&nbsp;</b></span><span><b><i>[3.1.2]</i></b><b><i>
&nbsp;<br />
</i></b></span></td></tr></table><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="14"><span><b><i></i></b></span><span class="mono"><b></b><font face="Symbol" size="2" color="#000000">&#183;</font><b></b></span></td><td><span class="mono"><b>print-debug</b></span><span><b><i>&nbsp;&nbsp;&nbsp;[3.4.0]</i></b></span><span class="mono"><b>
&nbsp;<br />
</b></span></td></tr></table><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td><span class="mono"><b></b></span></td><td></td></tr></table><span class="mono"></span><span>
<br />
<i>Внимание: рекомендуется в поле заголовка </i></span><span class="mono">errors-to</span><span> <i>задавать адрес, на который  может прийти сообщение об ошибке доставки письма. По-умолчанию </i>«</span><span class="mono">postmaster</span><span>»<i>.</i></span><span class="mono"><b>
<br />

<br />
charset</b></span><span> - если задан этот ключ, то заголовок и текстовые блоки сообщения будут перекодированы в указанную кодировку. По умолчанию сообщение отправляется в кодировке, заданной в </span><span class="mono"><b><a href="responsecharset.htm">$request:charset</a></b><b>&nbsp;</b></span><span>(т.е. не перекодируется).
<br />
</span><span class="mono"><b>
<br />
</b></span><span>Пример:
<br />
</span><span class="mono"><span class="monoblue"><b>$.charset[</b></span></span><span class="mono"><b>koi8-r</b><span class="monoblue"><b>]
<br />
</b></span></span><span class="mono"><b>
<br />
options</b></span><span> - эти опции будут переданы в командную строку программе </span><span class="mono">sendmail</span><span> (только под UNIX).</span><span class="mono"><b>
<br />
</b><b>
<br />
</b><b>print-debug</b></span><span> - при указании этой опции писомо не будет отправлено, вместо этого будет выведен полный сформированный текст письма, что может быть удобно при отладке сложных html-писем.</span><span class="mono"><b>
<br />
</b><b>
<br />
</b></span><span>Также можно задать все поля заголовка сообщения, передав их значение в таком виде (короткая форма):
<br />
</span><span class="mono"><span class="monoblue"><b>$.поле_заголовка[</b></span></span><span class="mono"><b>строка</b><span class="monoblue"><b>]
<br />
</b></span></span><span>или с параметрами (полная форма):
<br />
</span><span class="mono"><span class="monoblue"><b>$.поле_заголовка[
<br />
&nbsp;&nbsp;&nbsp;&nbsp;$.value[</b></span></span><span class="mono"><b>строка</b><span class="monoblue"><b>]
<br />
&nbsp;&nbsp;&nbsp;&nbsp;$.параметр[</b></span></span><span class="mono"><b>строка</b><span class="monoblue"><b>]</b></span></span><span class="mono"><b>
<br />
</b><span class="monoblue"><b>]</b></span></span><span class="mono"><b>
<br />
</b></span><span>
<br />
Примеры:</span><span class="mono"><b>
<br />
</b><span class="monoblue"><b>$.from</b></span></span><span class="mono"><b>[Вася&nbsp;&lt;vasya@hotmail.ru&gt;</b><span class="monoblue"><b>]
<br />
$.to[</b></span></span><span class="mono"><b>Петя&nbsp;&lt;petya@hotmail.ru&gt;</b><span class="monoblue"><b>]
<br />
</b></span></span><span class="mono"><span class="monoblue"><b>$.subject[</b></span></span><span class="mono"><b>Как&nbsp;у&nbsp;тебя&nbsp;дела?&nbsp;У&nbsp;меня&nbsp;-&nbsp;изумительно!</b><span class="monoblue"><b>]
<br />
</b></span></span><span class="mono"><span class="monoblue"><b>$.x-mailer[</b></span></span><span class="mono"><b>Parser&nbsp;3</b><span class="monoblue"><b>]
<br />
</b></span></span><span>
<br />
Кроме заголовка можно передать один или оба текстовых блока: </span><span class="mono"><b>text</b></span><span>, </span><span class="mono"><b>html</b></span><span>. А также любое количество блоков </span><span class="mono"><b>file</b></span><span> и </span><span class="mono"><b>message</b></span><span> (см. ниже).
<br />
Если будет передано оба текстовых блока, будет сформирована секция </span><span class="mono">MULTIPART/ALTERNATIVE</span><span>, при прочтении полученного сообщения современные почтовые клиенты покажут HTML, а устаревшие - простой текст.
<br />
Короткая форма:
<br />
</span><span class="mono"><span class="monoblue"><b>$.text[</b></span></span><span class="mono"><b>строка</b><span class="monoblue"><b>]
<br />
</b></span></span><span>Полная форма…
<br />
</span><span class="mono"><span class="monoblue"><b>$.text[
<br />
&nbsp;&nbsp;&nbsp;&nbsp;$.value[</b></span></span><span class="mono"><b>строка</b><span class="monoblue"><b>]
<br />
&nbsp;&nbsp;&nbsp;&nbsp;$</b></span></span><span class="mono"><b>.</b><span class="monoblue"><b>поле_заголовка[</b></span></span><span class="mono"><b>значение</b><span class="monoblue"><b>]
<br />
]</b></span></span><span>
<br />
…где </span><span class="mono"><b>value</b></span><span> - значение тестового блока, и можно задать все поля заголовка сообщения, передав их как и в хеше </span><span class="mono"><b>сообщение</b></span><span> (см. выше).
<br />
<i>Внимание: можно не передавать заголовок </i></span><span class="mono">content-type</span><span><i>, он будет сформирован автоматически. Этот заголовок не влияет на перекодирование, а влияет только на ту кодировку, в которой почтовый клиент будет отображать сообщение.
<br />
</i>
<br />
Отправка HTML. Короткая форма:
<br />
</span><span class="mono"><span class="monoblue"><b>$.html{</b></span></span><span class="mono"><b>строка</b><span class="monoblue"><b>}</b></span></span><span class="mono"><b>
<br />
</b></span><span>Полная форма:
<br />
</span><span class="mono"><span class="monoblue"><b>$.html[
<br />
&nbsp;&nbsp;&nbsp;&nbsp;$.value{</b></span></span><span class="mono"><b>строка</b><span class="monoblue"><b>}
<br />
&nbsp;&nbsp;&nbsp;&nbsp;$.поле_заголовка[</b></span></span><span class="mono"><b>значение</b><span class="monoblue"><b>]
<br />
]</b></span></span><span class="mono"><b>
<br />
</b></span><span><i>Фигурные скобки нужны для переключения </i><i><a href="tainting.htm">вида преобразования</a></i><i> по умолчанию на </i></span><span class="mono">HTML</span><span><i>.</i>
<br />

<br />
Вложение файла. Короткая форма:
<br />
</span><span class="mono"><span class="monoblue"><b>$.file[</b></span></span><span class="mono"><b>файл</b><span class="monoblue"><b>]</b></span></span><span class="mono"><b>
<br />
</b></span><span>Полная форма:
<br />
</span><span class="mono"><span class="monoblue"><b>$.file[
<br />
&nbsp;&nbsp;&nbsp;&nbsp;$.value[</b></span></span><span class="mono"><b>файл</b><span class="monoblue"><b>]
<br />
</b></span></span><span class="mono"><span class="monoblue"><b>&nbsp;&nbsp;&nbsp;&nbsp;</b></span></span><span class="mono"><span class="monoblue"><b>$.name[</b></span></span><span class="mono"><b>имя_файла</b><span class="monoblue"><b>]</b></span></span><span class="mono"><b>
<br />
</b><span class="monoblue"><b>&nbsp;&nbsp;&nbsp;&nbsp;</b></span></span><span class="mono"><span class="monoblue"><b>$.content-id[</b></span></span><span class="mono"><b>X</b><b>YZ</b><span class="monoblue"><b>]</b></span></span><span class="mono"><b>&nbsp;&nbsp;&nbsp;</b></span><span class="h1"><b>&nbsp;&nbsp;&nbsp;</b></span><span><b><i>[3.</i></b><b><i>2</i></b><b><i>.</i></b><b><i>2</i></b><b><i>]</i></b></span><span class="mono"><b>
<br />
</b><span class="monoblue"><b>&nbsp;&nbsp;&nbsp;&nbsp;</b></span></span><span class="mono"><span class="monoblue"><b>$.format[</b></span></span><span class="mono"><b>uue</b>|<b>base64</b><span class="monoblue"><b>]</b></span></span><span class="h1"><b>&nbsp;&nbsp;&nbsp;</b></span><span><b><i>[3.</i></b><b><i>2</i></b><b><i>.</i></b><b><i>2</i></b><b><i>]</i></b></span><span class="mono"><b>
<br />
</b><span class="monoblue"><b>&nbsp;&nbsp;&nbsp;&nbsp;$</b></span></span><span class="mono"><b>.</b><span class="monoblue"><b>поле_заголовка[</b></span></span><span class="mono"><b>значение</b><span class="monoblue"><b>]</b></span></span><span class="mono"><span class="monoblue"><b>
<br />
</b></span></span><span class="mono"><span class="monoblue"><b>]</b></span></span><span class="mono"><b>
<br />
</b><b>Файл</b></span><span> - объект класса </span><span class="mono"><b><a href="fileclass.htm">file</a></b></span><span>, который будет прикреплен к сообщению. MIME-тип данных (</span><span class="mono">content-type</span><span> заголовок части) определяется по таблице </span><span class="mono"><b>MIME-TYPES</b></span><span> (см. <a href="parserconfmethod.htm">Конфигурационный метод</a>).
<br />
</span><span class="mono"><b>Имя_файла</b></span><span> - имя, под которым файл будет передан.
<br />
<i>По умолчанию файл будет передан в </i></span><span class="mono">uuencode</span><span><i> форме (uue)</i><i> </i><i>до версии 3.4.0 и в </i><i>base64 </i><i>форме начиная с версии 3.4.0.
<br />
</i>
<br />
Вложение сообщения:
<br />
</span><span class="mono"><span class="monoblue"><b>$.message[</b></span></span><span class="mono"><b>сообщение</b><span class="monoblue"><b>]</b></span></span><span class="mono"><b>
<br />
</b></span><span>Формат сообщения такой же, как у параметра всего метода.
<br />

<br />
Вложений может быть несколько, для чего после имени следует добавить целое число. Пример:
<br />
</span><span class="mono"><span class="monoblue"><b>&nbsp;&nbsp;&nbsp;&nbsp;$.file
<br />
&nbsp;&nbsp;&nbsp;&nbsp;$.file</b></span></span><span class="mono"><b>2</b><span class="monoblue"><b>
<br />
&nbsp;&nbsp;&nbsp;&nbsp;$.message
<br />
&nbsp;&nbsp;&nbsp;&nbsp;$.message</b></span></span><span class="mono"><b>2</b><span class="monoblue"><b>
<br />
</b></span></span><span>
<br />
Пример с альтернативными блоками и вложениями:
<br />
</span><span class="mono"><span class="monoblue"><b>^mail:send[
<br />
&nbsp;&nbsp;&nbsp;&nbsp;$.from[</b></span></span><span class="mono"><b>Вася&nbsp;&lt;vasya@hotmail.ru&gt;</b><span class="monoblue"><b>]
<br />
&nbsp;&nbsp;&nbsp;&nbsp;$.to[</b></span></span><span class="mono"><b>Петя&nbsp;&lt;petya@hotmail.ru&gt;</b><span class="monoblue"><b>]
<br />
&nbsp;&nbsp;&nbsp;&nbsp;$.subject[</b></span></span><span class="mono"><b>как&nbsp;дела</b><span class="monoblue"><b>]
<br />
&nbsp;&nbsp;&nbsp;&nbsp;$.text[</b></span></span><span class="mono"><b>Как&nbsp;у&nbsp;тебя&nbsp;дела?&nbsp;У&nbsp;меня&nbsp;изумительно!</b><span class="monoblue"><b>]
<br />
&nbsp;&nbsp;&nbsp;&nbsp;$.html{</b></span></span><span class="mono"><b>Как&nbsp;у&nbsp;тебя&nbsp;дела?&nbsp;У&nbsp;меня&nbsp;&lt;b&gt;изумительно&lt;/b&gt;!
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&nbsp;/&gt;&lt;img&nbsp;src="cid:pic2"&nbsp;width="100"&nbsp;height="50"&nbsp;border="0"&nbsp;/&gt;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;</b><span class="monoblue"><b>}
<br />
&nbsp;&nbsp;&nbsp;&nbsp;$.file[^</b></span></span><span class="mono"><span class="monoblue"><b><a href="fileload.htm">file::load</a></b></span></span><span class="mono"><span class="monoblue"><b>[binary;</b></span></span><span class="mono"><b>perfect_life1.jpg</b><span class="monoblue"><b>]]
<br />
&nbsp;&nbsp;&nbsp;&nbsp;$.file2[
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.value[^file::load[binary;</b></span></span><span class="mono"><b>perfect_life2.jpg</b><span class="monoblue"><b>]]
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.name[</b></span></span><span class="mono"><b>изумительная_жизнь2.jpg</b><span class="monoblue"><b>]</b></span></span><span class="mono"><span class="monoblue"><b>
<br />
</b></span></span><span class="mono"><span class="monoblue"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.content-id[</b></span></span><span class="mono"><b>pic2</b><span class="monoblue"><b>]</b></span></span><span class="mono"><span class="monoblue"><b>
<br />
</b></span></span><span class="mono"><span class="monoblue"><b>&nbsp;&nbsp;&nbsp;&nbsp;]
<br />
]
<br />
</b></span></span><span>В результате будет отослано сообщение для </span><span class="mono"><b>petya@hotmail.ru</b></span><span> с содержимым «Как у тебя дела? У меня - изумительно!» в простом тексте и HTML. К сообщению будут приложены две подтверждающие фотографии, на которых…
<br />
</span></span><br />




</body>
</html>