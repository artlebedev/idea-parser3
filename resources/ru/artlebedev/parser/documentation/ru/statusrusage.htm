<html>
<head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html;charset=windows-1251">
    <meta name="keywords" content="status,status, Поля,rusage,profile *">
    <title>rusage. Информация о затраченных ресурсах</title>

    <script language="JavaScript"><!--
    if(top.frames.length==0) {
        top.location.href='./?statusrusage.htm'
    } else {
        if(document.referrer!='' && 0>document.referrer.indexOf(top.frames[0].location.pathname)) {
            top.frames[0].location.hash='statusrusage.htm'
        }
    }
    //--></script>

</head>

<body bgcolor="#FFFFFF" text="black">


<table border="0" cellspacing="0" cellpadding="2">
  <tr>
    <td>
      
<span style="font-family:FreeSetC,Arial; font-size:12pt; color:#000000"><b>rusage. Информация о затраченных ресурсах
<br>
</b></span>
    </td>
  </tr>
  <tr><td bgcolor="#99D228" height="3"></td></tr>
</table>
<br>



<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Это поле - <a href=hash.htm>хеш</a> с информацией о ресурсах сервера, затраченных на данный момент системой на обработку вашего Parser-скрипта.
<br>
Не все операционные системы умеют возвращать эти значения (WinNT/Win2000/WinXP умеет все, Win98 умеет только <span style="font-family:Monospace; font-size:10pt; color:#000000"><b>tv_sec</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> и </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>tv_usec</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> <b><i>[3.0.8]</i></b>).
<br>

<br>
<table border="0" cellpadding="1"><tr><td align="left" valign="top" width="67">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b><i>Ключ</i></b><b>
<br>
</b></span></td><td align="left" valign="top" width="88">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b><i>Единица</i></b>
<br>
</span></td><td align="left" valign="top" width="246">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b><i>Описание значения</i></b><b>
<br>
</b></span></td><td align="left" valign="top" width="243">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b><i>Как уменьшить?</i></b><b>
<br>
</b></span></td></tr><tr><td align="left" valign="top" width="67">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b>utime</b>
<br>
</span></td><td align="left" valign="top" width="88">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">секунда
<br>
</span></td><td align="left" valign="top" width="246">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Чистое время, затраченное текущим процессом
<br>
(не включает время, когда работали другие задачи)<span style="font-family:FreeSetC,Arial; font-size:8pt; color:#000000">
<br>
</span></span></td><td align="left" valign="top" width="243">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Упростить манипуляции с данными внутри Parser (улучшить алгоритм, переложить часть действий на SQL-сервер)
<br>
</span></td></tr><tr><td align="left" valign="top" width="67">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b>stime</b>
<br>
</span></td><td align="left" valign="top" width="88">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">секунда
<br>
</span></td><td align="left" valign="top" width="246">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Время, сколько система читала ваши файлы, каталоги, библиотеки
<br>
</span></td><td align="left" valign="top" width="243">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Уменьшить количество и размер необходимых для работы файлов, не <a href=opuse.htm>подключать</a> ненужные для обработки данного документа модули
<br>
</span></td></tr><tr><td align="left" valign="top" width="67">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b>maxrss</b>
<br>
</span></td><td align="left" valign="top" width="88">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">блок
<br>
</span></td><td align="left" valign="top" width="246">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Память, занимаемая процессом
<br>
</span></td><td align="left" valign="top" width="243">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Уменьшить количество загружаемых ненужных данных.
<br>
Найти и исправить все «<span style="font-family:Monospace; font-size:10pt; color:#000000">select&nbsp;*&nbsp;…</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">», задав список действительно необходимых полей. Не загружать из SQL-сервера ненужные записи, отфильтровать как можно больше средствами самого SQL-сервера.
<br>
</span></span></td></tr><tr><td align="left" valign="top" width="67">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
</span></td><td align="left" valign="top" width="88">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
</span></td><td align="left" valign="top" width="246">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><i>Точное системное время</i><i>.</i><i> Позволяет оценить траты времени на ожидание ответа от </i><i>SQL-, HTTP-, SMTP-</i><i>серверов</i><i>.
<br>

<br>

<br>
</i><i>Сколько прошло с </i><i>Epoch…</i>
<br>
</span></td><td align="left" valign="top" width="243">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Упростить SQL запросы, для MySQL воспользуйтесь <span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><u><a href="http://www.mysql.com/doc/en/EXPLAIN.html" target="_blank">EXPLAIN</a></u></span></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">; для Oracle: </span><span style="font-family:Monospace; font-size:10pt; color:#000000">EXPLAIN&nbsp;PLAN</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> (см. документацию по серверу); для других SQL-серверов: см. их документацию.
<br>
</span></span></td></tr><tr><td align="left" valign="top" width="67">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b>tv_sec</b>
<br>
</span></td><td align="left" valign="top" width="88">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">секунда
<br>
</span></td><td align="left" valign="top" width="246">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">…целых секунд;
<br>
</span></td><td align="left" valign="top" width="243">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
</span></td></tr><tr><td align="left" valign="top" width="67">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b>tv_usec</b>
<br>
</span></td><td align="left" valign="top" width="88">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">микросекунда
<br>
(10E-6)
<br>
</span></td><td align="left" valign="top" width="246">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">…еще прошло микросекунд
<br>
(миллионных долей секунды)
<br>
</span></td><td align="left" valign="top" width="243">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
</span></td></tr></table>
<br>

<br>
</span><span style="font-family:FreeSetC,Arial; font-size:12pt; color:#000000"><b>Рекомендуемый способ анализа
<br>
</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Временно добавьте в конец вашего скрипта вызов…
<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>^rusage[total]
<br>
</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
…вот этого метода…
<br>

<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>@rusage[comment][v;now;prefix;message;line;usec]
<br>
$v[$status:rusage]
<br>
$now[^</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=datenow.htm>date::now</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>[]]
<br>
$usec(^v.tv_usec.</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=intdoublefield.htm>double</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>[])
<br>
$prefix[[^now.</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=datesqlstring.htm>sql-string</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>[].^usec.</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=intdoubleformat.htm>format</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>[%06.0f]]&nbsp;</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=envhttpfield.htm>$env:REMOTE_ADDR</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>:&nbsp;$comment]
<br>
$message[$v.utime&nbsp;$v.stime&nbsp;</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=requesturi.htm>$request:uri</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>]
<br>
$line[$prefix&nbsp;$message&nbsp;</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=stringlit.htm>^#0A</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>]
<br>
^line.</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=stringsave.htm>save</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>[append;/rusage.log]
<br>
$</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=definemethod.htm>result</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>[]</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>
<br>
</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
…и проанализируйте журнал.
<br>

<br>
Для более точного анализа, добавьте  вызовы…
<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>^rusage[before&nbsp;XXX]
<br>
^rusage[after&nbsp;XXX]
<br>
</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
…вокруг интересующего вас блока.</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>
<br>
</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
<i>Примечание: для записи журнала не рекомендуется использовать веб-пространство.
<br>

<br>
</i></span><span style="font-family:FreeSetC,Arial; font-size:12pt; color:#000000"><b>WinNT/2K/XP
<br>
</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Под этими OS доступен ряд дополнительных значений:
<br>

<br>
<i><table border="0" cellpadding="1"><tr><td align="left" valign="top" width="215">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b><i>Ключ</i></b><b>
<br>
</b></span></td><td align="left" valign="top" width="60">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b><i>Единица</i></b>
<br>
</span></td><td align="left" valign="top" width="171">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b><i>Описание значения
<br>
</i></b></span></td><td align="left" valign="top" width="186">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b><i>Как уменьшить?
<br>
</i></b></span></td></tr><tr><td align="left" valign="top" width="215">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b>ReadOperationCount
<br>
ReadTransferCount</b><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>
<br>

<br>
</b></span></span></td><td align="left" valign="top" width="60">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">штук
<br>
байт
<br>
</span></td><td align="left" valign="top" width="171">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Количество операций чтения с диска и суммарное количество считанных байт
<br>
</span></td><td align="left" valign="top" width="186">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Уменьшить количество и размер необходимых для работы файлов, не <a href=opuse.htm>подключать</a> ненужные для обработки данного документа модули.
<br>

<br>
Больше использовать SQL-сервер, меньше файлы.
<br>
</span></td></tr><tr><td align="left" valign="top" width="215">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b>WriteOperationCount
<br>
WriteTransferCount</b><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>
<br>

<br>
</b></span></span></td><td align="left" valign="top" width="60">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">штука
<br>
байт<span style="font-family:MS Sans Serif; font-size:8pt; color:#000000">
<br>
</span></span></td><td align="left" valign="top" width="171">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Количество операций записи на диск и суммарное количество записанных байт
<br>
<span style="font-family:MS Sans Serif; font-size:8pt; color:#000000">
<br>
</span></span></td><td align="left" valign="top" width="186">
<span style="font-family:MS Sans Serif; font-size:8pt; color:#000000">
<br>
</span></td></tr><tr><td align="left" valign="top" width="215">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b>OtherOperationCount
<br>
OtherTransferCount</b><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>
<br>

<br>

<br>
</b></span></span></td><td align="left" valign="top" width="60">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">штука
<br>
байт<span style="font-family:MS Sans Serif; font-size:8pt; color:#000000">
<br>
</span></span></td><td align="left" valign="top" width="171">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Количество других операций с диском (не чтения/записи) и суммарное количество переданных байт
<br>
<span style="font-family:MS Sans Serif; font-size:8pt; color:#000000">
<br>
</span></span></td><td align="left" valign="top" width="186">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
</span></td></tr><tr><td align="left" valign="top" width="215">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b>PeakPagefileUsage
<br>
</b><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#9F9F9F"><b>QuotaPeakNonPagedPoolUsage
<br>
QuotaPeakPagedPoolUsage</b></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#9F9F9F"><b>
<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>
<br>
</b></span></span></td><td align="left" valign="top" width="60">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">байт
<br>
</span></td><td align="left" valign="top" width="171">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">Максимальное количество памяти в файле подкачки (swap-файле)
<br>
</span></td><td align="left" valign="top" width="186">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">см. комментарий к <b>maxrss</b> выше.<span style="font-family:MS Sans Serif; font-size:8pt; color:#000000">
<br>
</span></span></td></tr></table>
<br>
</i></span></span><br>

<!--#include virtual="/docs/comment.html" -->


<hr size=1>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr valign="top">
<td><font size="1">Copyright &copy; 1997&#150;2011 Art. Lebedev Studio | <a href="http://www.artlebedev.ru/" target="_blank">http://www.artlebedev.ru</a></font></td>
<td align="right"><font size="1">Дата обновления: 25.11.2010</font></td>
</tr>
</table>
</body>
</html>
