<html>
<head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html;charset=windows-1251">
    <meta name="keywords" content="table,table, Методы,hash">
    <title>hash. Преобразование таблицы к хешу с заданными ключами</title>

    <script language="JavaScript"><!--
    if(top.frames.length==0) {
        top.location.href='./?table2hash.htm'
    } else {
        if(document.referrer!='' && 0>document.referrer.indexOf(top.frames[0].location.pathname)) {
            top.frames[0].location.hash='table2hash.htm'
        }
    }
    //--></script>

</head>

<body bgcolor="#FFFFFF" text="black">


<table border="0" cellspacing="0" cellpadding="2">
  <tr>
    <td>
      
<span style="font-family:FreeSetC,Arial; font-size:12pt; color:#000000"><b>hash. Преобразование таблицы к хешу с заданными ключами
<br>
</b></span>
    </td>
  </tr>
  <tr><td bgcolor="#99D228" height="3"></td></tr>
</table>
<br>



<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>^таблица.hash[ключ]
<br>
^таблица.hash[ключ][опции]
<br>
^таблица.hash[ключ][столбец значений]
<br>
^таблица.hash[ключ][столбец значений][опции]
<br>
^таблица.hash[ключ][таблица со столбцами значений]
<br>
^таблица.hash[ключ][таблица со столбцами значений][опции]
<br>
</b><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>Ключ</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> может быть задан, как:
<br>
<table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="14"><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b></b><font face="Symbol" size="2" color="#000000">&#183;</font><b></b></span></td><td><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>[строка]</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> - название столбца, значение которого считается ключом;
&nbsp;<br>
</span></td></tr></table><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="14"><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b></b><font face="Symbol" size="2" color="#000000">&#183;</font><b></b></span></td><td><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>{код}</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> - результат исполнения которого считается ключом;
&nbsp;<br>
</span></td></tr></table><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="14"><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b></b><font face="Symbol" size="2" color="#000000">&#183;</font><b></b></span></td><td><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>(математическое выражение)</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> - результат вычисления которого считается ключом.
&nbsp;<br>
</span></td></tr></table><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"></span></td><td></td></tr></table><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><i>
<br>
</i>С опциями по умолчанию метод преобразует таблицу к <a href=hash.htm>хешу</a> вида:
<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$хеш[
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.значение_ключа[
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.название_столбца[значение_столбца]
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;…
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]
<br>
&nbsp;&nbsp;&nbsp;&nbsp;…
<br>
]
<br>
</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><i>
<br>
</i>Иными словами, метод создает хеш, в котором ключами являются значения, описанные параметром </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>ключ</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">. При этом каждому ключу ставится в соответствие хеш, в котором для всех столбцов таблицы хранятся ассоциации «название столбца - значение столбца в записи».
<br>

<br>
Если задан столбец значений, то каждому ключу будет соответствовать хеш с одной ассоциацией «название столбца - значение столбца в записи».
<br>

<br>
Кроме того, можно задать несколько столбцов значений, для этого необходимо передать дополнительным параметром таблицу, в которой перечислены все необходимые столбцы.
<br>

<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>Опции</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> - <a href=hash.htm>хеш</a> с опциями преобразования.
<br>
<table border="0" cellpadding="1"><tr><td align="left" valign="top" width="212">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$.type[hash/string/table]&nbsp;</b><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> <b><i>[3.2.2]</i></b>
<br>
</span></span></td><td align="left" valign="top" width="385">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>hash</b><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">=значение каждого элемента - хеш (по умолчанию);
<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>string</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">=значение каждого элемента - строка, при этом вы должны указать </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>один</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> столбец значений;
<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>table</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">=значение каждого элемента - таблица при этом вы не можете указать  </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>столбец&nbsp;значений</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> или </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>таблицa&nbsp;со&nbsp;столбцами&nbsp;значений.</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
Это сделано для экономии рессурсов, т.к. в результирующем хеше создаются таблицы со ссылками на строки таблиц уже расположенных в памяти, таким образом копирования строк таблиц с их содержимым не происходит.
<br>
</span></span></td></tr><tr><td align="left" valign="top" width="212">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$.distinct(0/1)</b><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> </span><span style="font-family:Monospace; font-size:10pt; color:#000000">
<br>
</span></span></td><td align="left" valign="top" width="385">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>0</b><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">=наличие в ключевом столбце одинаковых значений считается ошибкой (по-умолчанию);
<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>1</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">=выбрать из таблицы записи с уникальным ключом.</span><span style="font-family:Monospace; font-size:10pt; color:#000000">
<br>
</span></span></td></tr><tr><td align="left" valign="top" width="212">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$.distinct[tables]</b><b>
<br>
</b><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><b><i>[3.0.8]</i></b></span><span style="font-family:Monospace; font-size:10pt; color:#000000">
<br>
<b>
<br>
</b></span></span></td><td align="left" valign="top" width="385">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">создать <a href=hash.htm>хеш</a> из таблиц, содержащих строки с ключом. 
<br>
Это устаревший ключ, который равносилен одновременному заданию <span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$.distinct(1)</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> и </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$.type[table]</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">.</span><span style="font-family:Monospace; font-size:10pt; color:#000000">
<br>
</span></span></td></tr></table>
<br>

<br>
</span><span style="font-family:FreeSetC,Arial; font-size:12pt; color:#000000"><b>Пример</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
Есть список товаров, в котором каждый товар имеет наименование и уникальный код - </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>id</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">. Есть прайс-лист товаров, имеющихся в наличии. Вместо названия товара используется </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>id</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> товара из списка товаров. Все это хранится в двух таблицах. Подобные таблицы называются связанными. Нам нужно получить данные в виде «товар - цена», т.е. получить данные сразу из двух таблиц. 
<br>

<br>
Реализация:
<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>#&nbsp;это&nbsp;таблица&nbsp;с&nbsp;нашими&nbsp;товарами
<br>
$product_list[^table::</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=tablecreate.htm>create</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>{id&nbsp;&nbsp;&nbsp;name
<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>1&nbsp;&nbsp;&nbsp;хлеб
<br>
2&nbsp;&nbsp;&nbsp;колбаса
<br>
3&nbsp;&nbsp;&nbsp;масло&nbsp;
<br>
4&nbsp;&nbsp;&nbsp;водка</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>
<br>
}]
<br>

<br>
#&nbsp;это&nbsp;таблица&nbsp;с&nbsp;ценами&nbsp;товаров
<br>
$price_list[^table::create{id&nbsp;&nbsp;&nbsp;price
<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>1&nbsp;&nbsp;&nbsp;6.50
<br>
2&nbsp;&nbsp;&nbsp;70.00
<br>
3&nbsp;&nbsp;&nbsp;60.85</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>
<br>
}]
<br>

<br>
#hash&nbsp;таблицы&nbsp;с&nbsp;ценами&nbsp;по&nbsp;полю&nbsp;id
<br>
$price_list_hash[^price_list.hash[id]]&nbsp;
<br>

<br>
#перебираем&nbsp;записи&nbsp;таблицы&nbsp;с&nbsp;товарами
<br>
^product_list.</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=tablemenu.htm>menu</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>{&nbsp;
<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&nbsp;&nbsp;&nbsp;&nbsp;</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>$product_price[$price_list_hash.</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=vars.htm>[</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>$product_list.</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=tablefields.htm>id</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>].</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=hashfields.htm>price</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>]
<br>
#&nbsp;&nbsp;&nbsp;проверяем&nbsp;-&nbsp;есть&nbsp;ли&nbsp;цена&nbsp;на&nbsp;товар&nbsp;в&nbsp;нашем&nbsp;hash
<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&nbsp;&nbsp;&nbsp;&nbsp;</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>^if($product_price){&nbsp;
<br>
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;печатаем&nbsp;название&nbsp;товара&nbsp;и&nbsp;его&nbsp;цену
<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>$product_list.name</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&nbsp;-&nbsp;</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>$product_price</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&lt;br&nbsp;/&gt;</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>
<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&nbsp;&nbsp;&nbsp;&nbsp;</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>}{&nbsp;
<br>
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;а&nbsp;у&nbsp;этого&nbsp;товара&nbsp;нет&nbsp;цены,&nbsp;т.е.&nbsp;его&nbsp;нет&nbsp;в&nbsp;наличии
<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>$product_list.name</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&nbsp;-&nbsp;</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>нет&nbsp;в&nbsp;наличии</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&lt;br&nbsp;/&gt;</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>
<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&nbsp;&nbsp;&nbsp;&nbsp;</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>}&nbsp;
<br>
}
<br>
</b></span></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
В результате получим:
<br>
</span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&nbsp;&nbsp;&nbsp;&nbsp;хлеб&nbsp;-&nbsp;6.50
<br>
&nbsp;&nbsp;&nbsp;&nbsp;колбаса&nbsp;-&nbsp;70.00
<br>
&nbsp;&nbsp;&nbsp;&nbsp;масло&nbsp;-&nbsp;60.85
<br>
&nbsp;&nbsp;&nbsp;&nbsp;водка&nbsp;-&nbsp;нет&nbsp;в&nbsp;наличии</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
</span></span><br>

<!--#include virtual="/docs/comment.html" -->


<hr size=1>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr valign="top">
<td><font size="1">Copyright &copy; 1997&#150;2011 Art. Lebedev Studio | <a href="http://www.artlebedev.ru/" target="_blank">http://www.artlebedev.ru</a></font></td>
<td align="right"><font size="1">Дата обновления: 22.02.2011</font></td>
</tr>
</table>
</body>
</html>
