<html>
<head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html;charset=windows-1251">
    <meta name="keywords" content="math,math, Статические методы,crypt,password *,hashing passwords *,.htaccess *,htaccess *,apache passwords *">
    <title>crypt. Хеширование паролей</title>

    <script language="JavaScript"><!--
    if(top.frames.length==0) {
        top.location.href='./?mathcrypt.htm'
    } else {
        if(document.referrer!='' && 0>document.referrer.indexOf(top.frames[0].location.pathname)) {
            top.frames[0].location.hash='mathcrypt.htm'
        }
    }
    //--></script>

</head>

<body bgcolor="#FFFFFF" text="black">


<table border="0" cellspacing="0" cellpadding="2">
  <tr>
    <td>
      
<span style="font-family:FreeSetC,Arial; font-size:12pt; color:#000000"><b>crypt. Хеширование паролей
<br>
</b></span>
    </td>
  </tr>
  <tr><td bgcolor="#99D228" height="3"></td></tr>
</table>
<br>



<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>^math:crypt[password;salt]
<br>
</b><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
Хеширует </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>password</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> с учетом </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>salt</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">.
<br>

<br>
Параметры:
<br>
<table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="14"><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b></b><font face="Symbol" size="2" color="#000000">&#183;</font><b></b></span></td><td><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>password</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> - исходная строка;
&nbsp;<br>
</span></td></tr></table><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td width="14"><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b></b><font face="Symbol" size="2" color="#000000">&#183;</font><b></b></span></td><td><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>salt</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> - строка, определяющая алгоритм хеширования и вносящая элемент случайности в результат хеширования, состоит из начала и тела. Начало определяет алгоритм хеширования, тело вносит элемент случайности. Если тело не будет указано, Parser сформирует случайное.
&nbsp;<br>
</span></td></tr></table><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr valign="top"><td><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"></span></td><td></td></tr></table><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
Неразумно хранить пароли пользователей, просто записывая их на диск или в базу данных - ведь если предположить, что злоумышленник украдет файл или таблицу с паролями, он легко сможет ими воспользоваться. Поэтому принято хранить не пароли, а их <b>хеши </b>- результат надежного однозначного необратимого преобразования строки пароля. Для проверки введенного пароля к нему применяют то же преобразование, передавая в качестве </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>salt</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"> сохраненный хеш, а результат сверяют с сохраненным.
<br>

<br>
Вносить элемент случайности необходимо, поскольку иначе потенциальный злоумышленник может заранее сформировать таблицу хешей многих часто используемых паролей. Вторая причина: элемент случайности вносится на начальном этапе алгоритма хеширования, что существенно осложняет подбор пароля даже при использовании специальных аппаратных ускорителей.
<br>

<br>
Внимание: обязательно задавайте случайное тело </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>salt</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">, или позвольте Parser сделать это за вас, попросту не указывая тело </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>salt</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">, указывая только </span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>начало&nbsp;salt</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">.
<br>

<br>
Таблица доступных алгоритмов:
<br>
<table border="0" cellpadding="1"><tr><td align="left" valign="top" width="78">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><i>Алгоритм
<br>
</i></span></td><td align="left" valign="top" width="199">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><i>Описание
<br>
</i></span></td><td align="left" valign="top" width="161">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><i>Начало salt
<br>
</i></span></td><td align="left" valign="top" width="160">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><i>Тело "salt"
<br>
</i></span></td></tr><tr><td align="left" valign="top" width="78">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">MD5
<br>
</span></td><td align="left" valign="top" width="199">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">встроен в Parser, доступен на всех платформах
<br>
</span></td><td align="left" valign="top" width="161">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$apr1$</b><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
</span></span></td><td align="left" valign="top" width="160">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">до 8 случайных букв (в любом регистре) или цифр
<br>
</span></td></tr><tr><td align="left" valign="top" width="78">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">MD5
<br>
</span></td><td align="left" valign="top" width="199">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">если поддерживается операционной системой (UNIX)
<br>
</span></td><td align="left" valign="top" width="161">
<span style="font-family:Monospace; font-size:10pt; color:#000000"><b>$1$</b><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
</span></span></td><td align="left" valign="top" width="160">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">до 8 случайных букв (в любом регистре) или цифр
<br>
</span></td></tr><tr><td align="left" valign="top" width="78">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">DES
<br>
</span></td><td align="left" valign="top" width="199">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">если поддерживается операционной системой (UNIX)
<br>
</span></td><td align="left" valign="top" width="161">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">(нет)
<br>
</span></td><td align="left" valign="top" width="160">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">2 случайных буквы (в любом регистре) или цифры
<br>
</span></td></tr><tr><td align="left" valign="top" width="78">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">другие
<br>
</span></td><td align="left" valign="top" width="199">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">какие поддерживаются операционной системой (UNIX)
<br>
</span></td><td align="left" valign="top" width="161">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">читайте документацию на вашу операционную систему, функция <span style="font-family:Monospace; font-size:10pt; color:#000000">crypt</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
</span></span></td><td align="left" valign="top" width="160">
<span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">читайте документацию на вашу операционную систему, функция <span style="font-family:Monospace; font-size:10pt; color:#000000">crypt</span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
</span></span></td></tr></table>
<br>
<i>Внимание: в Parser для использования в тексте символа '$' его необходимо предварить символом '^'.</i>
<br>

<br>
<i>Примечание: Веб-сервер Apache допускает в файлах с паролями (</i></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><i>.htpasswd</i></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><i>) использовать хеши, сформированные по любому из алгоритмов, представленных в таблице, включая алгоритм, встроенный в Parser.
<br>
</i>
<br>
</span><span style="font-family:FreeSetC,Arial; font-size:12pt; color:#000000"><b>Пример создания .htpasswd файла
<br>
</b></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>@</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=mainclass.htm>main</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>[]
<br>
$users[^</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=tablecreate.htm>table::create</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>{name&nbsp;&nbsp;&nbsp;password
<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>alice&nbsp;&nbsp;&nbsp;xxxxxx
<br>
bob&nbsp;&nbsp;&nbsp;yyyyyy</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>
<br>
}]
<br>

<br>
$htpasswd[^table::create[nameless]{}]
<br>
^users.menu{
<br>
&nbsp;&nbsp;&nbsp;&nbsp;^htpasswd.append{$users.name:^math:crypt[$users.password;^$apr1^$]}
<br>
}
<br>

<br>
^htpasswd.save[nameless;.htpasswd-parser-test]
<br>
</b></span></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000">
<br>
</span><span style="font-family:FreeSetC,Arial; font-size:12pt; color:#000000"><b>Пример проверки пароля
<br>
</b></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>$right[</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>123</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>]
<br>
$from_user[</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>123</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>]
<br>
$crypted[^math:crypt[$right;^$apr1^$]]
<br>
#обратите&nbsp;внимание&nbsp;на&nbsp;то,&nbsp;что&nbsp;$crypted&nbsp;при&nbsp;каждом&nbsp;обращении&nbsp;разный
<br>
$crypted</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&lt;br&nbsp;/&gt;</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>
<br>
^if(^math:crypt[$from_user;$crypted]&nbsp;</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b><a href=exprops.htm>eq</a></b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>&nbsp;$crypted){
<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&nbsp;&nbsp;&nbsp;&nbsp;Казнить&nbsp;нельзя,&nbsp;помиловать
<br>
</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>}{
<br>
</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>&nbsp;&nbsp;&nbsp;&nbsp;Казнить,&nbsp;нельзя&nbsp;помиловать
<br>
</b><span style="font-family:Monospace; font-size:10pt; color:#0000FF"><b>}</b></span></span><span style="font-family:Monospace; font-size:10pt; color:#000000"><b>
<br>

<br>
</b></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><i>Подробная информация  о MD5 доступна здесь: </i><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#0000FF"><i><u><a href="http://www.ietf.org/rfc/rfc1321.txt" target="_blank">http://www.ietf.org/rfc/rfc1321.txt</a></u></i></span></span><span style="font-family:FreeSetC,Arial; font-size:10pt; color:#000000"><i>
<br>
</i></span></span><br>

<!--#include virtual="/docs/comment.html" -->


<hr size=1>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr valign="top">
<td><font size="1">Copyright &copy; 1997&#150;2011 Art. Lebedev Studio | <a href="http://www.artlebedev.ru/" target="_blank">http://www.artlebedev.ru</a></font></td>
<td align="right"><font size="1">Дата обновления: 23.02.2011</font></td>
</tr>
</table>
</body>
</html>
